(self.webpackChunk=self.webpackChunk||[]).push([[407],{44407:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AlchemyWebSocketProvider:()=>N});var n=s(2446),i=s(54178),o=s(65644),r=s(67178),l=s(8164),c=s(27801),a=s(56487),h=s(23792);let u=null;try{if(u=WebSocket,null==u)throw new Error("inject please")}catch(e){const t=new a.Yd(h.i);u=function(){t.throwError("WebSockets not supported in this environment",a.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new WebSocket()"})}}var d=s(25108),f=function(e,t,s,n){return new(s||(s=Promise))((function(i,o){function r(e){try{c(n.next(e))}catch(e){o(e)}}function l(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};const p=new a.Yd(h.i);let b=1;class m extends c.r{constructor(e,t){"any"===t&&p.throwError("WebSocketProvider does not support 'any' network yet",a.Yd.errors.UNSUPPORTED_OPERATION,{operation:"network:any"}),super("string"==typeof e?e:"_websocket",t),this._pollingInterval=-1,this._wsReady=!1,"string"==typeof e?(0,l.zG)(this,"_websocket",new u(this.connection.url)):(0,l.zG)(this,"_websocket",e),(0,l.zG)(this,"_requests",{}),(0,l.zG)(this,"_subs",{}),(0,l.zG)(this,"_subIds",{}),(0,l.zG)(this,"_detectNetwork",super.detectNetwork()),this.websocket.onopen=()=>{this._wsReady=!0,Object.keys(this._requests).forEach((e=>{this.websocket.send(this._requests[e].payload)}))},this.websocket.onmessage=e=>{const t=e.data,s=JSON.parse(t);if(null!=s.id){const e=String(s.id),n=this._requests[e];if(delete this._requests[e],void 0!==s.result)n.callback(null,s.result),this.emit("debug",{action:"response",request:JSON.parse(n.payload),response:s.result,provider:this});else{let e=null;s.error?(e=new Error(s.error.message||"unknown error"),(0,l.zG)(e,"code",s.error.code||null),(0,l.zG)(e,"response",t)):e=new Error("unknown error"),n.callback(e,void 0),this.emit("debug",{action:"response",error:e,request:JSON.parse(n.payload),provider:this})}}else if("eth_subscription"===s.method){const e=this._subs[s.params.subscription];e&&e.processFunc(s.params.result)}else d.warn("this should not happen")};const s=setInterval((()=>{this.emit("poll")}),1e3);s.unref&&s.unref()}get websocket(){return this._websocket}detectNetwork(){return this._detectNetwork}get pollingInterval(){return 0}resetEventsBlock(e){p.throwError("cannot reset events block on WebSocketProvider",a.Yd.errors.UNSUPPORTED_OPERATION,{operation:"resetEventBlock"})}set pollingInterval(e){p.throwError("cannot set polling interval on WebSocketProvider",a.Yd.errors.UNSUPPORTED_OPERATION,{operation:"setPollingInterval"})}poll(){return f(this,void 0,void 0,(function*(){return null}))}set polling(e){e&&p.throwError("cannot set polling on WebSocketProvider",a.Yd.errors.UNSUPPORTED_OPERATION,{operation:"setPolling"})}send(e,t){const s=b++;return new Promise(((n,i)=>{const o=JSON.stringify({method:e,params:t,id:s,jsonrpc:"2.0"});this.emit("debug",{action:"request",request:JSON.parse(o),provider:this}),this._requests[String(s)]={callback:function(e,t){return e?i(e):n(t)},payload:o},this._wsReady&&this.websocket.send(o)}))}static defaultUrl(){return"ws://localhost:8546"}_subscribe(e,t,s){return f(this,void 0,void 0,(function*(){let n=this._subIds[e];null==n&&(n=Promise.all(t).then((e=>this.send("eth_subscribe",e))),this._subIds[e]=n);const i=yield n;this._subs[i]={tag:e,processFunc:s}}))}_startEvent(e){switch(e.type){case"block":this._subscribe("block",["newHeads"],(e=>{const t=o.O$.from(e.number).toNumber();this._emitted.block=t,this.emit("block",t)}));break;case"pending":this._subscribe("pending",["newPendingTransactions"],(e=>{this.emit("pending",e)}));break;case"filter":this._subscribe(e.tag,["logs",this._getFilter(e.filter)],(t=>{null==t.removed&&(t.removed=!1),this.emit(e.filter,this.formatter.filterLog(t))}));break;case"tx":{const t=e=>{const t=e.hash;this.getTransactionReceipt(t).then((e=>{e&&this.emit(t,e)}))};t(e),this._subscribe("tx",["newHeads"],(e=>{this._events.filter((e=>"tx"===e.type)).forEach(t)}));break}case"debug":case"poll":case"willPoll":case"didPoll":case"error":break;default:d.log("unhandled:",e)}}_stopEvent(e){let t=e.tag;if("tx"===e.type){if(this._events.filter((e=>"tx"===e.type)).length)return;t="tx"}else if(this.listenerCount(e.event))return;const s=this._subIds[t];s&&(delete this._subIds[t],s.then((e=>{this._subs[e]&&(delete this._subs[e],this.send("eth_unsubscribe",[e]))})))}destroy(){return f(this,void 0,void 0,(function*(){this.websocket.readyState===u.CONNECTING&&(yield new Promise((e=>{this.websocket.onopen=function(){e(!0)},this.websocket.onerror=function(){e(!1)}}))),this.websocket.close(1e3)}))}}var v=s(79218),y=(s(9669),s(25108)),g=s(34155);class k{constructor(e){this.provider=e,this.maxBackfillBlocks=120}getNewHeadsBackfill(e,t,s){return(0,n._)(this,void 0,void 0,(function*(){I(e);const i=yield this.getBlockNumber();if(I(e),0===t.length)return this.getHeadEventsInRange(Math.max(s,i-this.maxBackfillBlocks)+1,i+1);const o=(0,n.f)(t[t.length-1].number),r=i-this.maxBackfillBlocks+1;if(o<=r)return this.getHeadEventsInRange(r,i+1);const l=yield this.getReorgHeads(e,t);I(e);const c=yield this.getHeadEventsInRange(o+1,i+1);return I(e),[...l,...c]}))}getLogsBackfill(e,t,s,i){return(0,n._)(this,void 0,void 0,(function*(){I(e);const o=yield this.getBlockNumber();if(I(e),0===s.length)return this.getLogsInRange(t,Math.max(i,o-this.maxBackfillBlocks)+1,o+1);const r=(0,n.f)(s[s.length-1].blockNumber),l=o-this.maxBackfillBlocks+1;if(r<l)return this.getLogsInRange(t,l,o+1);const c=yield this.getCommonAncestor(e,s);I(e);const a=s.filter((e=>(0,n.f)(e.blockNumber)>c.blockNumber)).map((e=>Object.assign(Object.assign({},e),{removed:!0}))),h=c.blockNumber===Number.NEGATIVE_INFINITY?(0,n.f)(s[0].blockNumber):c.blockNumber;let u=yield this.getLogsInRange(t,h,o+1);return u=u.filter((e=>e&&((0,n.f)(e.blockNumber)>c.blockNumber||(0,n.f)(e.logIndex)>c.logIndex))),I(e),[...a,...u]}))}setMaxBackfillBlock(e){this.maxBackfillBlocks=e}getBlockNumber(){return(0,n._)(this,void 0,void 0,(function*(){const e=yield this.provider.send("eth_blockNumber");return(0,n.f)(e)}))}getHeadEventsInRange(e,t){return(0,n._)(this,void 0,void 0,(function*(){if(e>=t)return[];const s=[];for(let i=e;i<t;i++)s.push({method:"eth_getBlockByNumber",params:[(0,n.t)(i),!1]});return(yield this.provider.sendBatch(s)).map(w)}))}getReorgHeads(e,t){return(0,n._)(this,void 0,void 0,(function*(){const s=[];for(let i=t.length-1;i>=0;i--){const o=t[i],r=yield this.getBlockByNumber((0,n.f)(o.number));if(I(e),o.hash===r.hash)break;s.push(w(r))}return s.reverse()}))}getBlockByNumber(e){return(0,n._)(this,void 0,void 0,(function*(){return this.provider.send("eth_getBlockByNumber",[(0,n.t)(e),!1])}))}getCommonAncestor(e,t){return(0,n._)(this,void 0,void 0,(function*(){let s=yield this.getBlockByNumber((0,n.f)(t[t.length-1].blockNumber));I(e);for(let e=t.length-1;e>=0;e--){const i=t[e];if(i.blockNumber!==s.number&&(s=yield this.getBlockByNumber((0,n.f)(i.blockNumber))),i.blockHash===s.hash)return{blockNumber:(0,n.f)(i.blockNumber),logIndex:(0,n.f)(i.logIndex)}}return{blockNumber:Number.NEGATIVE_INFINITY,logIndex:Number.NEGATIVE_INFINITY}}))}getLogsInRange(e,t,s){return(0,n._)(this,void 0,void 0,(function*(){if(t>=s)return[];const i=Object.assign(Object.assign({},e),{fromBlock:(0,n.t)(t),toBlock:(0,n.t)(s-1)});return this.provider.send("eth_getLogs",[i])}))}}function w(e){const t=Object.assign({},e);return delete t.totalDifficulty,delete t.transactions,delete t.uncles,t}function _(e,t){const s=new Set,n=[];return e.forEach((e=>{const i=t(e);s.has(i)||(s.add(i),n.push(e))})),n}const E=new Error("Cancelled");function I(e){if(e())throw E}class N extends m{constructor(e,t){var o;const r=v.AlchemyProvider.getApiKey(e.apiKey),l=v.AlchemyProvider.getAlchemyNetwork(e.network),c=v.AlchemyProvider.getAlchemyConnectionInfo(l,r,"wss"),a=`alchemy-sdk-${n.V}`;super(new i.Z(null!==(o=e.url)&&void 0!==o?o:c.url,a,{wsConstructor:null!=t?t:void 0!==g&&null!=g&&null!=g.versions&&null!=g.versions.node?s(45840).w3cwebsocket:WebSocket}),n.E[l]),this._events=[],this.virtualSubscriptionsById=new Map,this.virtualIdsByPhysicalId=new Map,this.handleMessage=e=>{const t=JSON.parse(e.data);if(!function(e){return!function(e){return Array.isArray(e)||"2.0"===e.jsonrpc&&void 0!==e.id}(e)}(t))return;const s=t.params.subscription,n=this.virtualIdsByPhysicalId.get(s);if(!n)return;const i=this.virtualSubscriptionsById.get(n);if("eth_subscribe"===i.method)switch(i.params[0]){case"newHeads":{const e=i,o=t,{isBackfilling:r,backfillBuffer:l}=e,{result:c}=o.params;r?function(e,t){P(e,t,B)}(l,c):s!==n?this.emitAndRememberEvent(n,c,B):this.rememberEvent(n,c,B);break}case"logs":{const e=i,o=t,{isBackfilling:r,backfillBuffer:l}=e,{result:c}=o.params;r?function(e,t){P(e,t,S)}(l,c):n!==s?this.emitAndRememberEvent(n,c,S):this.rememberEvent(n,c,S);break}default:if(s!==n){const{result:e}=t.params;this.emitEvent(n,e)}}},this.handleReopen=()=>{this.virtualIdsByPhysicalId.clear();const{cancel:e,isCancelled:t}=function(){let e=!1;return{cancel:()=>e=!0,isCancelled:()=>e}}();this.cancelBackfill=e;for(const e of this.virtualSubscriptionsById.values())(()=>{(0,n._)(this,void 0,void 0,(function*(){try{yield this.resubscribeAndBackfill(t,e)}catch(s){t()||y.error(`Error while backfilling "${e.params[0]}" subscription. Some events may be missing.`,s)}}))})();this.startHeartbeat()},this.stopHeartbeatAndBackfill=()=>{null!=this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.cancelBackfill()},this.apiKey=r,this.backfiller=new k(this),this.addSocketListeners(),this.startHeartbeat(),this.cancelBackfill=n.n}static getNetwork(e){return"string"==typeof e&&e in n.C?n.C[e]:(0,r.H)(e)}on(e,t){return this._addEventListener(e,t,!1)}once(e,t){return this._addEventListener(e,t,!0)}off(e,t){return(0,n.i)(e)?this._off(e,t):super.off(e,t)}removeAllListeners(e){return void 0!==e&&(0,n.i)(e)?this._removeAllListeners(e):super.removeAllListeners(e)}listenerCount(e){return void 0!==e&&(0,n.i)(e)?this._listenerCount(e):super.listenerCount(e)}listeners(e){return void 0!==e&&(0,n.i)(e)?this._listeners(e):super.listeners(e)}_addEventListener(e,t,s){if((0,n.i)(e)){(0,n.v)(e);const i=new n.c((0,n.e)(e),t,s);return this._events.push(i),this._startEvent(i),this}return super._addEventListener(e,t,s)}_startEvent(e){[...n.A,"block","filter"].includes(e.type)?this.customStartEvent(e):super._startEvent(e)}_subscribe(e,t,s,i){return(0,n._)(this,void 0,void 0,(function*(){let n=this._subIds[e];const o=yield this.getBlockNumber();null==n&&(n=Promise.all(t).then((e=>this.send("eth_subscribe",e))),this._subIds[e]=n);const r=yield n,l=yield Promise.all(t);this.virtualSubscriptionsById.set(r,{event:i,method:"eth_subscribe",params:l,startingBlockNumber:o,virtualId:r,physicalId:r,sentEvents:[],isBackfilling:!1,backfillBuffer:[]}),this.virtualIdsByPhysicalId.set(r,r),this._subs[r]={tag:e,processFunc:s}}))}emit(e,...t){if((0,n.i)(e)){let s=!1;const i=[],o=(0,n.e)(e);return this._events=this._events.filter((e=>e.tag!==o||(setTimeout((()=>{e.listener.apply(this,t)}),0),s=!0,!e.once||(i.push(e),!1)))),i.forEach((e=>{this._stopEvent(e)})),s}return super.emit(e,...t)}sendBatch(e){return(0,n._)(this,void 0,void 0,(function*(){let t=0;const s=e.map((({method:e,params:s})=>({method:e,params:s,jsonrpc:"2.0",id:"alchemy-sdk:"+t++})));return this.sendBatchConcurrently(s)}))}destroy(){return this.removeSocketListeners(),this.stopHeartbeatAndBackfill(),super.destroy()}isCommunityResource(){return this.apiKey===n.D}_stopEvent(e){let t=e.tag;if(n.A.includes(e.type)){if(this._events.filter((e=>n.A.includes(e.type))).length)return}else if("tx"===e.type){if(this._events.filter((e=>"tx"===e.type)).length)return;t="tx"}else if(this.listenerCount(e.event))return;const s=this._subIds[t];s&&(delete this._subIds[t],s.then((e=>{this._subs[e]&&(delete this._subs[e],this.send("eth_unsubscribe",[e]))})))}addSocketListeners(){this._websocket.addEventListener("message",this.handleMessage),this._websocket.addEventListener("reopen",this.handleReopen),this._websocket.addEventListener("down",this.stopHeartbeatAndBackfill)}removeSocketListeners(){this._websocket.removeEventListener("message",this.handleMessage),this._websocket.removeEventListener("reopen",this.handleReopen),this._websocket.removeEventListener("down",this.stopHeartbeatAndBackfill)}resubscribeAndBackfill(e,t){return(0,n._)(this,void 0,void 0,(function*(){const{virtualId:s,method:n,params:i,sentEvents:o,backfillBuffer:r,startingBlockNumber:l}=t;t.isBackfilling=!0,r.length=0;try{const a=yield this.send(n,i);switch(I(e),t.physicalId=a,this.virtualIdsByPhysicalId.set(a,s),i[0]){case"newHeads":{const t=yield T((()=>C(this.backfiller.getNewHeadsBackfill(e,o,l),6e4)),5,(()=>!e()));I(e),(c=[...t,...r],_(c,(e=>e.hash))).forEach((e=>this.emitNewHeadsEvent(s,e)));break}case"logs":{const t=i[1]||{},n=yield T((()=>C(this.backfiller.getLogsBackfill(e,t,o,l),6e4)),5,(()=>!e()));I(e),function(e){return _(e,(e=>`${e.blockHash}/${e.logIndex}`))}([...n,...r]).forEach((e=>this.emitLogsEvent(s,e)));break}}}finally{t.isBackfilling=!1,r.length=0}var c}))}emitNewHeadsEvent(e,t){this.emitAndRememberEvent(e,t,B)}emitLogsEvent(e,t){this.emitAndRememberEvent(e,t,S)}emitAndRememberEvent(e,t,s){this.rememberEvent(e,t,s),this.emitEvent(e,t)}emitEvent(e,t){const s=this.virtualSubscriptionsById.get(e);s&&this.emitGenericEvent(s,t)}rememberEvent(e,t,s){const n=this.virtualSubscriptionsById.get(e);n&&P(n.sentEvents,Object.assign({},t),s)}emitGenericEvent(e,t){this.emitProcessFn(e.event)(t)}startHeartbeat(){null==this.heartbeatIntervalId&&(this.heartbeatIntervalId=setInterval((()=>(0,n._)(this,void 0,void 0,(function*(){try{yield C(this.send("net_version"),1e4)}catch(e){this._websocket.reconnect()}}))),3e4))}sendBatchConcurrently(e){return(0,n._)(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>this.send(e.method,e.params))))}))}customStartEvent(e){if(e.type===n.h){const{fromAddress:t,toAddress:s,hashesOnly:i}=e;this._subscribe(e.tag,[n.j.PENDING_TRANSACTIONS,{fromAddress:t,toAddress:s,hashesOnly:i}],this.emitProcessFn(e),e)}else if(e.type===n.k){const{addresses:t,includeRemoved:s,hashesOnly:i}=e;this._subscribe(e.tag,[n.j.MINED_TRANSACTIONS,{addresses:t,includeRemoved:s,hashesOnly:i}],this.emitProcessFn(e),e)}else"block"===e.type?this._subscribe("block",["newHeads"],this.emitProcessFn(e),e):"filter"===e.type&&this._subscribe(e.tag,["logs",this._getFilter(e.filter)],this.emitProcessFn(e),e)}emitProcessFn(e){switch(e.type){case n.h:return t=>this.emit({method:n.j.PENDING_TRANSACTIONS,fromAddress:e.fromAddress,toAddress:e.toAddress,hashesOnly:e.hashesOnly},t);case n.k:return t=>this.emit({method:n.j.MINED_TRANSACTIONS,addresses:e.addresses,includeRemoved:e.includeRemoved,hashesOnly:e.hashesOnly},t);case"block":return e=>{const t=o.O$.from(e.number).toNumber();this._emitted.block=t,this.emit("block",t)};case"filter":return t=>{null==t.removed&&(t.removed=!1),this.emit(e.filter,this.formatter.filterLog(t))};default:throw new Error("Invalid event type to `emitProcessFn()`")}}_off(e,t){if(null==t)return this.removeAllListeners(e);const s=[];let i=!1;const o=(0,n.e)(e);return this._events=this._events.filter((e=>e.tag!==o||e.listener!=t||!!i||(i=!0,s.push(e),!1))),s.forEach((e=>{this._stopEvent(e)})),this}_removeAllListeners(e){let t=[];if(null==e)t=this._events,this._events=[];else{const s=(0,n.e)(e);this._events=this._events.filter((e=>e.tag!==s||(t.push(e),!1)))}return t.forEach((e=>{this._stopEvent(e)})),this}_listenerCount(e){if(!e)return this._events.length;const t=(0,n.e)(e);return this._events.filter((e=>e.tag===t)).length}_listeners(e){if(null==e)return this._events.map((e=>e.listener));const t=(0,n.e)(e);return this._events.filter((e=>e.tag===t)).map((e=>e.listener))}}function T(e,t,s=(()=>!0)){return(0,n._)(this,void 0,void 0,(function*(){let n=0,i=0;for(;;)try{return yield e()}catch(e){if(i++,i>=t||!s(e))throw e;if(yield O(n),!s(e))throw e;n=0===n?1e3:Math.min(3e4,2*n)}}))}function O(e){return new Promise((t=>setTimeout(t,e)))}function C(e,t){return Promise.race([e,new Promise(((e,s)=>setTimeout((()=>s(new Error("Timeout"))),t)))])}function B(e){return(0,n.f)(e.number)}function S(e){return(0,n.f)(e.blockNumber)}function P(e,t,s){const n=s(t),i=e.findIndex((e=>s(e)>n-10));-1===i?e.length=0:e.splice(0,i),e.push(t)}},284:e=>{var t=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},54178:(e,t,s)=>{"use strict";var n=s(25108),i=function(){function e(t,s,n){if(void 0===n&&(n={}),this.url=t,this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.ondown=null,this.onreopen=null,this.CONNECTING=e.CONNECTING,this.OPEN=e.OPEN,this.CLOSING=e.CLOSING,this.CLOSED=e.CLOSED,this.hasBeenOpened=!1,this.isClosed=!1,this.messageBuffer=[],this.nextRetryTime=0,this.reconnectCount=0,this.lastKnownExtensions="",this.lastKnownProtocol="",this.listeners={},null==s||"string"==typeof s||Array.isArray(s)?this.protocols=s:n=s,this.options=o(n),!this.options.wsConstructor){if("undefined"==typeof WebSocket)throw new Error("WebSocket not present in global scope and no wsConstructor option was provided.");this.options.wsConstructor=WebSocket}this.openNewWebSocket()}return Object.defineProperty(e.prototype,"binaryType",{get:function(){return this.binaryTypeInternal||"blob"},set:function(e){this.binaryTypeInternal=e,this.ws&&(this.ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){var e=this.ws?this.ws.bufferedAmount:0,t=!1;return this.messageBuffer.forEach((function(s){var n=function(e){return"string"==typeof e?2*e.length:e instanceof ArrayBuffer?e.byteLength:e instanceof Blob?e.size:void 0}(s);null!=n?e+=n:t=!0})),t&&this.debugLog("Some buffered data had unknown length. bufferedAmount() return value may be below the correct amount."),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this.ws?this.ws.extensions:this.lastKnownExtensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this.ws?this.ws.protocol:this.lastKnownProtocol},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.isClosed?e.CLOSED:e.OPEN},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){this.disposeSocket(e,t),this.shutdown(),this.debugLog("WebSocket permanently closed by client.")},e.prototype.send=function(e){if(this.isClosed)throw new Error("WebSocket is already in CLOSING or CLOSED state.");this.ws&&this.ws.readyState===this.OPEN?this.ws.send(e):this.messageBuffer.push(e)},e.prototype.reconnect=function(){if(this.isClosed)throw new Error("Cannot call reconnect() on socket which is permanently closed.");this.disposeSocket(1e3,"Client requested reconnect."),this.handleClose(void 0)},e.prototype.addEventListener=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.dispatchEvent=function(e){return this.dispatchEventOfType(e.type,e)},e.prototype.removeEventListener=function(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((function(e){return e!==t})))},e.prototype.openNewWebSocket=function(){var e=this;if(!this.isClosed){var t=this.options,s=t.connectTimeout,n=t.wsConstructor;this.debugLog("Opening new WebSocket to "+this.url+".");var i=new n(this.url,this.protocols);i.onclose=function(t){return e.handleClose(t)},i.onerror=function(t){return e.handleError(t)},i.onmessage=function(t){return e.handleMessage(t)},i.onopen=function(t){return e.handleOpen(t)},this.connectTimeoutId=setTimeout((function(){e.clearConnectTimeout(),e.disposeSocket(),e.handleClose(void 0)}),s),this.ws=i}},e.prototype.handleOpen=function(e){var t=this;if(this.ws&&!this.isClosed){var s=this.options.allClearResetTime;this.debugLog("WebSocket opened."),null!=this.binaryTypeInternal?this.ws.binaryType=this.binaryTypeInternal:this.binaryTypeInternal=this.ws.binaryType,this.clearConnectTimeout(),this.hasBeenOpened?this.dispatchEventOfType("reopen",e):(this.dispatchEventOfType("open",e),this.hasBeenOpened=!0),this.messageBuffer.forEach((function(e){return t.send(e)})),this.messageBuffer=[],this.allClearTimeoutId=setTimeout((function(){t.clearAllClearTimeout(),t.nextRetryTime=0,t.reconnectCount=0;var e=s/1e3|0;t.debugLog("WebSocket remained open for "+e+" seconds. Resetting retry time and count.")}),s)}},e.prototype.handleMessage=function(e){this.isClosed||this.dispatchEventOfType("message",e)},e.prototype.handleClose=function(e){var t=this;if(!this.isClosed){var s=this.options,n=s.maxReconnectAttempts,i=s.shouldReconnect;if(this.clearConnectTimeout(),this.clearAllClearTimeout(),this.ws&&(this.lastKnownExtensions=this.ws.extensions,this.lastKnownProtocol=this.ws.protocol,this.disposeSocket()),this.dispatchEventOfType("down",e),this.reconnectCount>=n)this.stopReconnecting(e,this.getTooManyFailedReconnectsMessage());else{var o=!e||i(e);"boolean"==typeof o?this.handleWillReconnect(o,e,"Provided shouldReconnect() returned false. Closing permanently."):o.then((function(s){t.isClosed||t.handleWillReconnect(s,e,"Provided shouldReconnect() resolved to false. Closing permanently.")}))}}},e.prototype.handleError=function(e){this.dispatchEventOfType("error",e),this.debugLog("WebSocket encountered an error.")},e.prototype.handleWillReconnect=function(e,t,s){e?this.reestablishConnection():this.stopReconnecting(t,s)},e.prototype.reestablishConnection=function(){var e=this,t=this.options,s=t.minReconnectDelay,n=t.maxReconnectDelay,i=t.reconnectBackoffFactor;this.reconnectCount++;var o=this.nextRetryTime;this.nextRetryTime=Math.max(s,Math.min(this.nextRetryTime*i,n)),setTimeout((function(){return e.openNewWebSocket()}),o);var r=o/1e3|0;this.debugLog("WebSocket was closed. Re-opening in "+r+" seconds.")},e.prototype.stopReconnecting=function(e,t){this.debugLog(t),this.shutdown(),e&&this.dispatchEventOfType("close",e)},e.prototype.shutdown=function(){this.isClosed=!0,this.clearAllTimeouts(),this.messageBuffer=[],this.disposeSocket()},e.prototype.disposeSocket=function(e,t){this.ws&&(this.ws.onerror=r,this.ws.onclose=r,this.ws.onmessage=r,this.ws.onopen=r,this.ws.close(e,t),this.ws=void 0)},e.prototype.clearAllTimeouts=function(){this.clearConnectTimeout(),this.clearAllClearTimeout()},e.prototype.clearConnectTimeout=function(){null!=this.connectTimeoutId&&(clearTimeout(this.connectTimeoutId),this.connectTimeoutId=void 0)},e.prototype.clearAllClearTimeout=function(){null!=this.allClearTimeoutId&&(clearTimeout(this.allClearTimeoutId),this.allClearTimeoutId=void 0)},e.prototype.dispatchEventOfType=function(e,t){var s=this;switch(e){case"close":this.onclose&&this.onclose(t);break;case"error":this.onerror&&this.onerror(t);break;case"message":this.onmessage&&this.onmessage(t);break;case"open":this.onopen&&this.onopen(t);break;case"down":this.ondown&&this.ondown(t);break;case"reopen":this.onreopen&&this.onreopen(t)}return e in this.listeners&&this.listeners[e].slice().forEach((function(e){return s.callListener(e,t)})),!t||!t.defaultPrevented},e.prototype.callListener=function(e,t){"function"==typeof e?e.call(this,t):e.handleEvent.call(this,t)},e.prototype.debugLog=function(e){this.options.debug&&n.log(e)},e.prototype.getTooManyFailedReconnectsMessage=function(){var e,t=this.options.maxReconnectAttempts;return"Failed to reconnect after "+t+" "+(e="attempt",(1===t?e:e+"s")+". Closing permanently.")},e.DEFAULT_OPTIONS={allClearResetTime:5e3,connectTimeout:5e3,debug:!1,minReconnectDelay:1e3,maxReconnectDelay:3e4,maxReconnectAttempts:Number.POSITIVE_INFINITY,reconnectBackoffFactor:1.5,shouldReconnect:function(){return!0},wsConstructor:void 0},e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3,e}();function o(e){var t={};return Object.keys(i.DEFAULT_OPTIONS).forEach((function(s){var n=e[s];t[s]=void 0===n?i.DEFAULT_OPTIONS[s]:n})),t}function r(){}t.Z=i},45840:(e,t,s)=>{var n;if("object"==typeof globalThis)n=globalThis;else try{n=s(284)}catch(e){}finally{if(n||"undefined"==typeof window||(n=window),!n)throw new Error("Could not determine global this")}var i=n.WebSocket||n.MozWebSocket,o=s(79387);function r(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(r,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?r:null,version:o}},79387:(e,t,s)=>{e.exports=s(19794).version},19794:e=>{"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLEVBUWQsT0FQQWlCLE9BQU9DLEtBQUsyUSxFQUFnQjZFLGlCQUFpQnRWLFNBQVEsU0FBVXNJLEdBQzNELElBQUkvSixFQUFRb1MsRUFBUXJJLEdBQ3BCMUosRUFBTzBKLFFBQ08zSCxJQUFWcEMsRUFDTWtTLEVBQWdCNkUsZ0JBQWdCaE4sR0FDaEMvSixDQUNkLElBQ09LLENBQ1gsQ0FtQkEsU0FBU2lXLElBRVQsQ0FoQ0ExRSxFQUFRLEVBQVVNLEMsa0JDbFhsQixJQUFJK0UsRUFDSixHQUEwQixpQkFBZnBGLFdBQ1ZvRixFQUFjcEYsZ0JBRWQsSUFDQ29GLEVBQWMsRUFBUSxJQUt2QixDQUpFLE1BQU85WCxHQUNULENBQUUsUUFFRCxHQURLOFgsR0FBaUMsb0JBQVh2RixTQUEwQnVGLEVBQWN2RixTQUM5RHVGLEVBQWUsTUFBTSxJQUFJL1gsTUFBTSxrQ0FDckMsQ0FHRCxJQUFJZ1ksRUFBa0JELEVBQVloWSxXQUFhZ1ksRUFBWUUsYUFDdkRDLEVBQW9CLEVBQVEsT0FNaEMsU0FBU0MsRUFBYUMsRUFBS25FLEdBaUIxQixPQWRJQSxFQUNlLElBQUkrRCxFQUFnQkksRUFBS25FLEdBR3pCLElBQUkrRCxFQUFnQkksRUFXeEMsQ0FDSUosR0FDSCxDQUFDLGFBQWMsT0FBUSxVQUFXLFVBQVV6VixTQUFRLFNBQVM4VixHQUM1RGpXLE9BQU93USxlQUFldUYsRUFBY0UsRUFBTSxDQUN6QzdMLElBQUssV0FBYSxPQUFPd0wsRUFBZ0JLLEVBQU8sR0FFbEQsSUFNRDVGLEVBQU9DLFFBQVUsQ0FDYixhQUFpQnNGLEVBQWtCRyxFQUFlLEtBQ2xELFFBQWlCRCxFLGtCQ3BEckJ6RixFQUFPQyxRQUFVLEVBQWpCLGMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYWxjaGVteS1zZGsvbm9kZV9tb2R1bGVzL0BldGhlcnNwcm9qZWN0L3Byb3ZpZGVycy9saWIuZXNtL3dzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hbGNoZW15LXNkay9ub2RlX21vZHVsZXMvQGV0aGVyc3Byb2plY3QvcHJvdmlkZXJzL2xpYi5lc20vd2Vic29ja2V0LXByb3ZpZGVyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hbGNoZW15LXNkay9kaXN0L2VzbS9hbGNoZW15LXdlYnNvY2tldC1wcm92aWRlci03YjFlMzViMi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZXM1LWV4dC9nbG9iYWwuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N0dXJkeS13ZWJzb2NrZXQvZGlzdC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvd2Vic29ja2V0L2xpYi9icm93c2VyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy93ZWJzb2NrZXQvbGliL3ZlcnNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tIFwiQGV0aGVyc3Byb2plY3QvbG9nZ2VyXCI7XG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIi4vX3ZlcnNpb25cIjtcbmxldCBXUyA9IG51bGw7XG50cnkge1xuICAgIFdTID0gV2ViU29ja2V0O1xuICAgIGlmIChXUyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImluamVjdCBwbGVhc2VcIik7XG4gICAgfVxufVxuY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcih2ZXJzaW9uKTtcbiAgICBXUyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbG9nZ2VyLnRocm93RXJyb3IoXCJXZWJTb2NrZXRzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudFwiLCBMb2dnZXIuZXJyb3JzLlVOU1VQUE9SVEVEX09QRVJBVElPTiwge1xuICAgICAgICAgICAgb3BlcmF0aW9uOiBcIm5ldyBXZWJTb2NrZXQoKVwiXG4gICAgICAgIH0pO1xuICAgIH07XG59XG4vL2V4cG9ydCBkZWZhdWx0IFdTO1xuLy9tb2R1bGUuZXhwb3J0cyA9IFdTO1xuZXhwb3J0IHsgV1MgYXMgV2ViU29ja2V0IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD13cy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSBcIkBldGhlcnNwcm9qZWN0L2JpZ251bWJlclwiO1xuaW1wb3J0IHsgZGVmaW5lUmVhZE9ubHkgfSBmcm9tIFwiQGV0aGVyc3Byb2plY3QvcHJvcGVydGllc1wiO1xuaW1wb3J0IHsgSnNvblJwY1Byb3ZpZGVyIH0gZnJvbSBcIi4vanNvbi1ycGMtcHJvdmlkZXJcIjtcbmltcG9ydCB7IFdlYlNvY2tldCB9IGZyb20gXCIuL3dzXCI7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tIFwiQGV0aGVyc3Byb2plY3QvbG9nZ2VyXCI7XG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIi4vX3ZlcnNpb25cIjtcbmNvbnN0IGxvZ2dlciA9IG5ldyBMb2dnZXIodmVyc2lvbik7XG4vKipcbiAqICBOb3RlczpcbiAqXG4gKiAgVGhpcyBwcm92aWRlciBkaWZmZXJzIGEgYml0IGZyb20gdGhlIHBvbGxpbmcgcHJvdmlkZXJzLiBPbmUgbWFpblxuICogIGRpZmZlcmVuY2UgaXMgaG93IGl0IGhhbmRsZXMgY29uc2lzdGVuY3kuIFRoZSBwb2xsaW5nIHByb3ZpZGVyc1xuICogIHdpbGwgc3RhbGwgcmVzcG9uc2VzIHRvIGVuc3VyZSBhIGNvbnNpc3RlbnQgc3RhdGUsIHdoaWxlIHRoaXNcbiAqICBXZWJTb2NrZXQgcHJvdmlkZXIgYXNzdW1lcyB0aGUgY29ubmVjdGVkIGJhY2tlbmQgd2lsbCBtYW5hZ2UgdGhpcy5cbiAqXG4gKiAgRm9yIGV4YW1wbGUsIGlmIGEgcG9sbGluZyBwcm92aWRlciBlbWl0cyBhbiBldmVudCB3aGljaCBpbmRpY2F0ZXNcbiAqICB0aGUgZXZlbnQgb2NjdXJyZWQgaW4gYmxvY2toYXNoIFhYWCwgYSBjYWxsIHRvIGZldGNoIHRoYXQgYmxvY2sgYnlcbiAqICBpdHMgaGFzaCBYWFgsIGlmIG5vdCBwcmVzZW50IHdpbGwgcmV0cnkgdW50aWwgaXQgaXMgcHJlc2VudC4gVGhpc1xuICogIGNhbiBvY2N1ciB3aGVuIHF1ZXJ5aW5nIGEgcG9vbCBvZiBub2RlcyB0aGF0IGFyZSBtaWxkbHkgb3V0IG9mIHN5bmNcbiAqICB3aXRoIGVhY2ggb3RoZXIuXG4gKi9cbmxldCBOZXh0SWQgPSAxO1xuLy8gRm9yIG1vcmUgaW5mbyBhYm91dCB0aGUgUmVhbC10aW1lIEV2ZW50IEFQSSBzZWU6XG4vLyAgIGh0dHBzOi8vZ2V0aC5ldGhlcmV1bS5vcmcvZG9jcy9ycGMvcHVic3ViXG5leHBvcnQgY2xhc3MgV2ViU29ja2V0UHJvdmlkZXIgZXh0ZW5kcyBKc29uUnBjUHJvdmlkZXIge1xuICAgIGNvbnN0cnVjdG9yKHVybCwgbmV0d29yaykge1xuICAgICAgICAvLyBUaGlzIHdpbGwgYmUgYWRkZWQgaW4gdGhlIGZ1dHVyZTsgcGxlYXNlIG9wZW4gYW4gaXNzdWUgdG8gZXhwZWRpdGVcbiAgICAgICAgaWYgKG5ldHdvcmsgPT09IFwiYW55XCIpIHtcbiAgICAgICAgICAgIGxvZ2dlci50aHJvd0Vycm9yKFwiV2ViU29ja2V0UHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCAnYW55JyBuZXR3b3JrIHlldFwiLCBMb2dnZXIuZXJyb3JzLlVOU1VQUE9SVEVEX09QRVJBVElPTiwge1xuICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogXCJuZXR3b3JrOmFueVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mICh1cmwpID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBzdXBlcih1cmwsIG5ldHdvcmspO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VwZXIoXCJfd2Vic29ja2V0XCIsIG5ldHdvcmspO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BvbGxpbmdJbnRlcnZhbCA9IC0xO1xuICAgICAgICB0aGlzLl93c1JlYWR5ID0gZmFsc2U7XG4gICAgICAgIGlmICh0eXBlb2YgKHVybCkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGRlZmluZVJlYWRPbmx5KHRoaXMsIFwiX3dlYnNvY2tldFwiLCBuZXcgV2ViU29ja2V0KHRoaXMuY29ubmVjdGlvbi51cmwpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlZmluZVJlYWRPbmx5KHRoaXMsIFwiX3dlYnNvY2tldFwiLCB1cmwpO1xuICAgICAgICB9XG4gICAgICAgIGRlZmluZVJlYWRPbmx5KHRoaXMsIFwiX3JlcXVlc3RzXCIsIHt9KTtcbiAgICAgICAgZGVmaW5lUmVhZE9ubHkodGhpcywgXCJfc3Vic1wiLCB7fSk7XG4gICAgICAgIGRlZmluZVJlYWRPbmx5KHRoaXMsIFwiX3N1Yklkc1wiLCB7fSk7XG4gICAgICAgIGRlZmluZVJlYWRPbmx5KHRoaXMsIFwiX2RldGVjdE5ldHdvcmtcIiwgc3VwZXIuZGV0ZWN0TmV0d29yaygpKTtcbiAgICAgICAgLy8gU3RhbGwgc2VuZGluZyByZXF1ZXN0cyB1bnRpbCB0aGUgc29ja2V0IGlzIG9wZW4uLi5cbiAgICAgICAgdGhpcy53ZWJzb2NrZXQub25vcGVuID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fd3NSZWFkeSA9IHRydWU7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLl9yZXF1ZXN0cykuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndlYnNvY2tldC5zZW5kKHRoaXMuX3JlcXVlc3RzW2lkXS5wYXlsb2FkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLndlYnNvY2tldC5vbm1lc3NhZ2UgPSAobWVzc2FnZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gbWVzc2FnZUV2ZW50LmRhdGE7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5pZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSBTdHJpbmcocmVzdWx0LmlkKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5fcmVxdWVzdHNbaWRdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9yZXF1ZXN0c1tpZF07XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXN1bHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LmNhbGxiYWNrKG51bGwsIHJlc3VsdC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJkZWJ1Z1wiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwicmVzcG9uc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3Q6IEpTT04ucGFyc2UocmVxdWVzdC5wYXlsb2FkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiByZXN1bHQucmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHRoaXNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IubWVzc2FnZSB8fCBcInVua25vd24gZXJyb3JcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVSZWFkT25seShlcnJvciwgXCJjb2RlXCIsIHJlc3VsdC5lcnJvci5jb2RlIHx8IG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmaW5lUmVhZE9ubHkoZXJyb3IsIFwicmVzcG9uc2VcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBFcnJvcihcInVua25vd24gZXJyb3JcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5jYWxsYmFjayhlcnJvciwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwiZGVidWdcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcInJlc3BvbnNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0OiBKU09OLnBhcnNlKHJlcXVlc3QucGF5bG9hZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlcjogdGhpc1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyZXN1bHQubWV0aG9kID09PSBcImV0aF9zdWJzY3JpcHRpb25cIikge1xuICAgICAgICAgICAgICAgIC8vIFN1YnNjcmlwdGlvbi4uLlxuICAgICAgICAgICAgICAgIGNvbnN0IHN1YiA9IHRoaXMuX3N1YnNbcmVzdWx0LnBhcmFtcy5zdWJzY3JpcHRpb25dO1xuICAgICAgICAgICAgICAgIGlmIChzdWIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLmVtaXQuYXBwbHkodGhpcywgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBzdWIucHJvY2Vzc0Z1bmMocmVzdWx0LnBhcmFtcy5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcInRoaXMgc2hvdWxkIG5vdCBoYXBwZW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIFRoaXMgUHJvdmlkZXIgZG9lcyBub3QgYWN0dWFsbHkgcG9sbCwgYnV0IHdlIHdhbnQgdG8gdHJpZ2dlclxuICAgICAgICAvLyBwb2xsIGV2ZW50cyBmb3IgdGhpbmdzIHRoYXQgZGVwZW5kIG9uIHRoZW0gKGxpa2Ugc3RhbGxpbmcgZm9yXG4gICAgICAgIC8vIGJsb2NrIGFuZCB0cmFuc2FjdGlvbiBsb29rdXBzKVxuICAgICAgICBjb25zdCBmYXV4UG9sbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcInBvbGxcIik7XG4gICAgICAgIH0sIDEwMDApO1xuICAgICAgICBpZiAoZmF1eFBvbGwudW5yZWYpIHtcbiAgICAgICAgICAgIGZhdXhQb2xsLnVucmVmKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gQ2Fubm90IG5hcnJvdyB0aGUgdHlwZSBvZiBfd2Vic29ja2V0LCBhcyB0aGF0IGlzIG5vdCBiYWNrd2FyZHMgY29tcGF0aWJsZVxuICAgIC8vIHNvIHdlIGFkZCBhIGdldHRlciBhbmQgbGV0IHRoZSBXZWJTb2NrZXQgYmUgYSBwdWJsaWMgQVBJLlxuICAgIGdldCB3ZWJzb2NrZXQoKSB7IHJldHVybiB0aGlzLl93ZWJzb2NrZXQ7IH1cbiAgICBkZXRlY3ROZXR3b3JrKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGV0ZWN0TmV0d29yaztcbiAgICB9XG4gICAgZ2V0IHBvbGxpbmdJbnRlcnZhbCgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIHJlc2V0RXZlbnRzQmxvY2soYmxvY2tOdW1iZXIpIHtcbiAgICAgICAgbG9nZ2VyLnRocm93RXJyb3IoXCJjYW5ub3QgcmVzZXQgZXZlbnRzIGJsb2NrIG9uIFdlYlNvY2tldFByb3ZpZGVyXCIsIExvZ2dlci5lcnJvcnMuVU5TVVBQT1JURURfT1BFUkFUSU9OLCB7XG4gICAgICAgICAgICBvcGVyYXRpb246IFwicmVzZXRFdmVudEJsb2NrXCJcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldCBwb2xsaW5nSW50ZXJ2YWwodmFsdWUpIHtcbiAgICAgICAgbG9nZ2VyLnRocm93RXJyb3IoXCJjYW5ub3Qgc2V0IHBvbGxpbmcgaW50ZXJ2YWwgb24gV2ViU29ja2V0UHJvdmlkZXJcIiwgTG9nZ2VyLmVycm9ycy5VTlNVUFBPUlRFRF9PUEVSQVRJT04sIHtcbiAgICAgICAgICAgIG9wZXJhdGlvbjogXCJzZXRQb2xsaW5nSW50ZXJ2YWxcIlxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcG9sbCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0IHBvbGxpbmcodmFsdWUpIHtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxvZ2dlci50aHJvd0Vycm9yKFwiY2Fubm90IHNldCBwb2xsaW5nIG9uIFdlYlNvY2tldFByb3ZpZGVyXCIsIExvZ2dlci5lcnJvcnMuVU5TVVBQT1JURURfT1BFUkFUSU9OLCB7XG4gICAgICAgICAgICBvcGVyYXRpb246IFwic2V0UG9sbGluZ1wiXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kKG1ldGhvZCwgcGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHJpZCA9IE5leHRJZCsrO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soZXJyb3IsIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgaWQ6IHJpZCxcbiAgICAgICAgICAgICAgICBqc29ucnBjOiBcIjIuMFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChcImRlYnVnXCIsIHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IFwicmVxdWVzdFwiLFxuICAgICAgICAgICAgICAgIHJlcXVlc3Q6IEpTT04ucGFyc2UocGF5bG9hZCksXG4gICAgICAgICAgICAgICAgcHJvdmlkZXI6IHRoaXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdHNbU3RyaW5nKHJpZCldID0geyBjYWxsYmFjaywgcGF5bG9hZCB9O1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dzUmVhZHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndlYnNvY2tldC5zZW5kKHBheWxvYWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGRlZmF1bHRVcmwoKSB7XG4gICAgICAgIHJldHVybiBcIndzOi9cXC9sb2NhbGhvc3Q6ODU0NlwiO1xuICAgIH1cbiAgICBfc3Vic2NyaWJlKHRhZywgcGFyYW0sIHByb2Nlc3NGdW5jKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBsZXQgc3ViSWRQcm9taXNlID0gdGhpcy5fc3ViSWRzW3RhZ107XG4gICAgICAgICAgICBpZiAoc3ViSWRQcm9taXNlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdWJJZFByb21pc2UgPSBQcm9taXNlLmFsbChwYXJhbSkudGhlbigocGFyYW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZChcImV0aF9zdWJzY3JpYmVcIiwgcGFyYW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N1Yklkc1t0YWddID0gc3ViSWRQcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc3ViSWQgPSB5aWVsZCBzdWJJZFByb21pc2U7XG4gICAgICAgICAgICB0aGlzLl9zdWJzW3N1YklkXSA9IHsgdGFnLCBwcm9jZXNzRnVuYyB9O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgX3N0YXJ0RXZlbnQoZXZlbnQpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwiYmxvY2tcIjpcbiAgICAgICAgICAgICAgICB0aGlzLl9zdWJzY3JpYmUoXCJibG9ja1wiLCBbXCJuZXdIZWFkc1wiXSwgKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IEJpZ051bWJlci5mcm9tKHJlc3VsdC5udW1iZXIpLnRvTnVtYmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZWQuYmxvY2sgPSBibG9ja051bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwiYmxvY2tcIiwgYmxvY2tOdW1iZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInBlbmRpbmdcIjpcbiAgICAgICAgICAgICAgICB0aGlzLl9zdWJzY3JpYmUoXCJwZW5kaW5nXCIsIFtcIm5ld1BlbmRpbmdUcmFuc2FjdGlvbnNcIl0sIChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwicGVuZGluZ1wiLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImZpbHRlclwiOlxuICAgICAgICAgICAgICAgIHRoaXMuX3N1YnNjcmliZShldmVudC50YWcsIFtcImxvZ3NcIiwgdGhpcy5fZ2V0RmlsdGVyKGV2ZW50LmZpbHRlcildLCAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucmVtb3ZlZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucmVtb3ZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdChldmVudC5maWx0ZXIsIHRoaXMuZm9ybWF0dGVyLmZpbHRlckxvZyhyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0eFwiOiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW1pdFJlY2VpcHQgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzaCA9IGV2ZW50Lmhhc2g7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJhbnNhY3Rpb25SZWNlaXB0KGhhc2gpLnRoZW4oKHJlY2VpcHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVjZWlwdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdChoYXNoLCByZWNlaXB0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBJbiBjYXNlIGl0IGlzIGFscmVhZHkgbWluZWRcbiAgICAgICAgICAgICAgICBlbWl0UmVjZWlwdChldmVudCk7XG4gICAgICAgICAgICAgICAgLy8gVG8ga2VlcCB0aGluZ3Mgc2ltcGxlLCB3ZSBzdGFydCB1cCBhIHNpbmdsZSBuZXdIZWFkcyBzdWJzY3JpcHRpb25cbiAgICAgICAgICAgICAgICAvLyB0byBrZWVwIGFuIGV5ZSBvdXQgZm9yIHRyYW5zYWN0aW9ucyB3ZSBhcmUgd2F0Y2hpbmcgZm9yLlxuICAgICAgICAgICAgICAgIC8vIFN0YXJ0aW5nIGEgc3Vic2NyaXB0aW9uIGZvciBhbiBldmVudCAoaS5lLiBcInR4XCIpIHRoYXQgaXMgYWxyZWFkeVxuICAgICAgICAgICAgICAgIC8vIHJ1bm5pbmcgaXMgKGJhc2ljYWxseSkgYSBub3AuXG4gICAgICAgICAgICAgICAgdGhpcy5fc3Vic2NyaWJlKFwidHhcIiwgW1wibmV3SGVhZHNcIl0sIChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzLmZpbHRlcigoZSkgPT4gKGUudHlwZSA9PT0gXCJ0eFwiKSkuZm9yRWFjaChlbWl0UmVjZWlwdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBOb3RoaW5nIGlzIG5lZWRlZFxuICAgICAgICAgICAgY2FzZSBcImRlYnVnXCI6XG4gICAgICAgICAgICBjYXNlIFwicG9sbFwiOlxuICAgICAgICAgICAgY2FzZSBcIndpbGxQb2xsXCI6XG4gICAgICAgICAgICBjYXNlIFwiZGlkUG9sbFwiOlxuICAgICAgICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidW5oYW5kbGVkOlwiLCBldmVudCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3N0b3BFdmVudChldmVudCkge1xuICAgICAgICBsZXQgdGFnID0gZXZlbnQudGFnO1xuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJ0eFwiKSB7XG4gICAgICAgICAgICAvLyBUaGVyZSBhcmUgcmVtYWluaW5nIHRyYW5zYWN0aW9uIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICAgICAgaWYgKHRoaXMuX2V2ZW50cy5maWx0ZXIoKGUpID0+IChlLnR5cGUgPT09IFwidHhcIikpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhZyA9IFwidHhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmxpc3RlbmVyQ291bnQoZXZlbnQuZXZlbnQpKSB7XG4gICAgICAgICAgICAvLyBUaGVyZSBhcmUgcmVtYWluaW5nIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN1YklkID0gdGhpcy5fc3ViSWRzW3RhZ107XG4gICAgICAgIGlmICghc3ViSWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5fc3ViSWRzW3RhZ107XG4gICAgICAgIHN1YklkLnRoZW4oKHN1YklkKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3N1YnNbc3ViSWRdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3N1YnNbc3ViSWRdO1xuICAgICAgICAgICAgdGhpcy5zZW5kKFwiZXRoX3Vuc3Vic2NyaWJlXCIsIFtzdWJJZF0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIC8vIFdhaXQgdW50aWwgd2UgaGF2ZSBjb25uZWN0ZWQgYmVmb3JlIHRyeWluZyB0byBkaXNjb25uZWN0XG4gICAgICAgICAgICBpZiAodGhpcy53ZWJzb2NrZXQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCAobmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53ZWJzb2NrZXQub25vcGVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53ZWJzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEhhbmd1cFxuICAgICAgICAgICAgLy8gU2VlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ2xvc2VFdmVudCNTdGF0dXNfY29kZXNcbiAgICAgICAgICAgIHRoaXMud2Vic29ja2V0LmNsb3NlKDEwMDApO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWJzb2NrZXQtcHJvdmlkZXIuanMubWFwIiwiaW1wb3J0IHsgXyBhcyBfX2F3YWl0ZXIsIGYgYXMgZnJvbUhleCwgdCBhcyB0b0hleCwgbiBhcyBub29wLCBDIGFzIEN1c3RvbU5ldHdvcmtzLCBpIGFzIGlzQWxjaGVteUV2ZW50LCB2IGFzIHZlcmlmeUFsY2hlbXlFdmVudE5hbWUsIGMgYXMgRXRoZXJzRXZlbnQsIGUgYXMgZ2V0QWxjaGVteUV2ZW50VGFnLCBEIGFzIERFRkFVTFRfQUxDSEVNWV9BUElfS0VZLCBBIGFzIEFMQ0hFTVlfRVZFTlRfVFlQRVMsIGggYXMgQUxDSEVNWV9QRU5ESU5HX1RSQU5TQUNUSU9OU19FVkVOVF9UWVBFLCBqIGFzIEFsY2hlbXlTdWJzY3JpcHRpb24sIGsgYXMgQUxDSEVNWV9NSU5FRF9UUkFOU0FDVElPTlNfRVZFTlRfVFlQRSwgViBhcyBWRVJTSU9OLCBFIGFzIEV0aGVyc05ldHdvcmsgfSBmcm9tICcuL2luZGV4LTJkZTI5M2ZiLmpzJztcbmltcG9ydCBTdHVyZHlXZWJTb2NrZXQgZnJvbSAnc3R1cmR5LXdlYnNvY2tldCc7XG5pbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdAZXRoZXJzcHJvamVjdC9iaWdudW1iZXInO1xuaW1wb3J0IHsgZ2V0TmV0d29yayB9IGZyb20gJ0BldGhlcnNwcm9qZWN0L25ldHdvcmtzJztcbmltcG9ydCB7IFdlYlNvY2tldFByb3ZpZGVyIH0gZnJvbSAnQGV0aGVyc3Byb2plY3QvcHJvdmlkZXJzJztcbmltcG9ydCB7IEFsY2hlbXlQcm92aWRlciB9IGZyb20gJy4vYWxjaGVteS1wcm92aWRlci1lNGNmODBhNi5qcyc7XG5pbXBvcnQgJy4vYXBpL3V0aWxzJztcbmltcG9ydCAnYXhpb3MnO1xuaW1wb3J0ICdAZXRoZXJzcHJvamVjdC9hYnN0cmFjdC1wcm92aWRlcic7XG5pbXBvcnQgJ0BldGhlcnNwcm9qZWN0L3dhbGxldCc7XG5pbXBvcnQgJ0BldGhlcnNwcm9qZWN0L2NvbnRyYWN0cyc7XG5pbXBvcnQgJ0BldGhlcnNwcm9qZWN0L3dlYic7XG5cbi8qKlxyXG4gKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgYmxvY2tzIHRvIGJhY2tmaWxsLiBJZiBtb3JlIHRoYW4gdGhpcyBtYW55IGJsb2NrcyBoYXZlXHJcbiAqIGJlZW4gbWlzc2VkLCB0aGVuIHdlJ2xsIHNhZGx5IG1pc3MgZGF0YSwgYnV0IHdlIHdhbnQgdG8gbWFrZSBzdXJlIHdlIGRvbid0XHJcbiAqIGVuZCB1cCByZXF1ZXN0aW5nIHRob3VzYW5kcyBvZiBibG9ja3MgaWYgc29tZWJvZHkgbGVmdCB0aGVpciBsYXB0b3AgY2xvc2VkIGZvciBhIHdlZWsuXHJcbiAqL1xyXG5jb25zdCBNQVhfQkFDS0ZJTExfQkxPQ0tTID0gMTIwO1xyXG4vKipcclxuICogVGhlIFdlYnNvY2tldEJhY2tmaWxsZXIgZmV0Y2hlcyBldmVudHMgdGhhdCB3ZXJlIHNlbnQgc2luY2UgYSBwcm92aWRlZCBibG9ja1xyXG4gKiBudW1iZXIuIFRoaXMgaXMgdXNlZCBpbiB0aGUge0BsaW5rIEFsY2hlbXlXZWJTb2NrZXRQcm92aWRlcn0gdG8gYmFja2ZpbGxcclxuICogZXZlbnRzIHRoYXQgd2VyZSB0cmFuc21pdHRlZCB3aGlsZSB0aGUgd2Vic29ja2V0IGNvbm5lY3Rpb24gd2FzIGRvd24uXHJcbiAqXHJcbiAqIFRoZSBiYWNrZmlsbGVyIGJhY2tmaWxscyB0d28gbWFpbiBldGhfc3Vic2NyaWJlIGV2ZW50czogYGxvZ3NgIGFuZCBgbmV3SGVhZHNgLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIFdlYnNvY2tldEJhY2tmaWxsZXIge1xyXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXIpIHtcclxuICAgICAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXI7XHJcbiAgICAgICAgLy8gVE9ETzogVXNlIEhUVFAgcHJvdmlkZXIgdG8gZG8gYmFja2ZpbGwuXHJcbiAgICAgICAgdGhpcy5tYXhCYWNrZmlsbEJsb2NrcyA9IE1BWF9CQUNLRklMTF9CTE9DS1M7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJ1bnMgYmFja2ZpbGwgZm9yIGBuZXdIZWFkc2AgZXZlbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpc0NhbmNlbGxlZCBXaGV0aGVyIHRoZSBiYWNrZmlsbCByZXF1ZXN0IGlzIGNhbmNlbGxlZC5cclxuICAgICAqIEBwYXJhbSBwcmV2aW91c0hlYWRzIFByZXZpb3VzIGhlYWQgcmVxdWVzdHMgdGhhdCB3ZXJlIHNlbnQuXHJcbiAgICAgKiBAcGFyYW0gZnJvbUJsb2NrTnVtYmVyIFRoZSBibG9jayBudW1iZXIgdG8gc3RhcnQgYmFja2ZpbGxpbmcgZnJvbS5cclxuICAgICAqIEByZXR1cm5zIEEgbGlzdCBvZiBgbmV3SGVhZHNgIGV2ZW50cyB0aGF0IHdlcmUgc2VudCBzaW5jZSB0aGUgbGFzdCBiYWNrZmlsbC5cclxuICAgICAqL1xyXG4gICAgZ2V0TmV3SGVhZHNCYWNrZmlsbChpc0NhbmNlbGxlZCwgcHJldmlvdXNIZWFkcywgZnJvbUJsb2NrTnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgdGhyb3dJZkNhbmNlbGxlZChpc0NhbmNlbGxlZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvQmxvY2tOdW1iZXIgPSB5aWVsZCB0aGlzLmdldEJsb2NrTnVtYmVyKCk7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gcHJldmlvdXMgaGVhZHMgdG8gZmV0Y2gsIHJldHVybiBuZXcgaGVhZHMgc2luY2VcclxuICAgICAgICAgICAgLy8gYGZyb21CbG9ja051bWJlcmAsIG9yIHVwIHRvIG1heEJhY2tmaWxsQmxvY2tzIGZyb20gdGhlIGN1cnJlbnQgaGVhZC5cclxuICAgICAgICAgICAgaWYgKHByZXZpb3VzSGVhZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRIZWFkRXZlbnRzSW5SYW5nZShNYXRoLm1heChmcm9tQmxvY2tOdW1iZXIsIHRvQmxvY2tOdW1iZXIgLSB0aGlzLm1heEJhY2tmaWxsQmxvY2tzKSArIDEsIHRvQmxvY2tOdW1iZXIgKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBJZiB0aGUgbGFzdCBlbWl0dGVkIGV2ZW50IGlzIHRvbyBmYXIgYmFjayBpbiB0aGUgcGFzdCwgdGhlcmUncyBubyBuZWVkXHJcbiAgICAgICAgICAgIC8vIHRvIGJhY2tmaWxsIGZvciByZW9yZ3MuIEp1c3QgZmV0Y2ggdGhlIGxhc3QgYG1heEJhY2tmaWxsQmxvY2tzYCB3b3J0aCBvZlxyXG4gICAgICAgICAgICAvLyBuZXcgaGVhZHMuXHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3RTZWVuQmxvY2tOdW1iZXIgPSBmcm9tSGV4KHByZXZpb3VzSGVhZHNbcHJldmlvdXNIZWFkcy5sZW5ndGggLSAxXS5udW1iZXIpO1xyXG4gICAgICAgICAgICBjb25zdCBtaW5CbG9ja051bWJlciA9IHRvQmxvY2tOdW1iZXIgLSB0aGlzLm1heEJhY2tmaWxsQmxvY2tzICsgMTtcclxuICAgICAgICAgICAgaWYgKGxhc3RTZWVuQmxvY2tOdW1iZXIgPD0gbWluQmxvY2tOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEhlYWRFdmVudHNJblJhbmdlKG1pbkJsb2NrTnVtYmVyLCB0b0Jsb2NrTnVtYmVyICsgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVG8gY2FwdHVyZSBhbGwgYG5ld0hlYWRzYCBldmVudHMsIHJldHVybiBhbGwgaGVhZCBldmVudHMgZnJvbSB0aGUgbGFzdFxyXG4gICAgICAgICAgICAvLyBzZWVuIGJsb2NrIG51bWJlciB0byBjdXJyZW50ICsgYW55IG9mIHRoZSBwcmV2aW91cyBoZWFkcyB0aGF0IHdlcmUgcmUtb3JnZWQuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlb3JnSGVhZHMgPSB5aWVsZCB0aGlzLmdldFJlb3JnSGVhZHMoaXNDYW5jZWxsZWQsIHByZXZpb3VzSGVhZHMpO1xyXG4gICAgICAgICAgICB0aHJvd0lmQ2FuY2VsbGVkKGlzQ2FuY2VsbGVkKTtcclxuICAgICAgICAgICAgY29uc3QgaW50ZXJtZWRpYXRlSGVhZHMgPSB5aWVsZCB0aGlzLmdldEhlYWRFdmVudHNJblJhbmdlKGxhc3RTZWVuQmxvY2tOdW1iZXIgKyAxLCB0b0Jsb2NrTnVtYmVyICsgMSk7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gWy4uLnJlb3JnSGVhZHMsIC4uLmludGVybWVkaWF0ZUhlYWRzXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUnVucyBiYWNrZmlsbCBmb3IgYGxvZ3NgIGV2ZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaXNDYW5jZWxsZWQgV2hldGhlciB0aGUgYmFja2ZpbGwgcmVxdWVzdCBpcyBjYW5jZWxsZWQuXHJcbiAgICAgKiBAcGFyYW0gZmlsdGVyIFRoZSBmaWx0ZXIgb2JqZWN0IHRoYXQgYWNjb21wYW5pZXMgYSBsb2dzIHN1YnNjcmlwdGlvbi5cclxuICAgICAqIEBwYXJhbSBwcmV2aW91c0xvZ3MgUHJldmlvdXMgbG9nIHJlcXVlc3RzIHRoYXQgd2VyZSBzZW50LlxyXG4gICAgICogQHBhcmFtIGZyb21CbG9ja051bWJlciBUaGUgYmxvY2sgbnVtYmVyIHRvIHN0YXJ0IGJhY2tmaWxsaW5nIGZyb20uXHJcbiAgICAgKi9cclxuICAgIGdldExvZ3NCYWNrZmlsbChpc0NhbmNlbGxlZCwgZmlsdGVyLCBwcmV2aW91c0xvZ3MsIGZyb21CbG9ja051bWJlcikge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICBjb25zdCB0b0Jsb2NrTnVtYmVyID0geWllbGQgdGhpcy5nZXRCbG9ja051bWJlcigpO1xyXG4gICAgICAgICAgICB0aHJvd0lmQ2FuY2VsbGVkKGlzQ2FuY2VsbGVkKTtcclxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vIHByZXZpb3VzIGxvZ3MgdG8gZmV0Y2gsIHJldHVybiBuZXcgbG9ncyBzaW5jZVxyXG4gICAgICAgICAgICAvLyBgZnJvbUJsb2NrTnVtYmVyYCwgb3IgdXAgdG8gYG1heEJhY2tmaWxsQmxvY2tzYCBmcm9tIHRoZSBjdXJyZW50IGhlYWQuXHJcbiAgICAgICAgICAgIGlmIChwcmV2aW91c0xvZ3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRMb2dzSW5SYW5nZShmaWx0ZXIsIE1hdGgubWF4KGZyb21CbG9ja051bWJlciwgdG9CbG9ja051bWJlciAtIHRoaXMubWF4QmFja2ZpbGxCbG9ja3MpICsgMSwgdG9CbG9ja051bWJlciArIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBsYXN0IGVtaXR0ZWQgbG9nIGlzIHRvbyBmYXIgYmFjayBpbiB0aGUgcGFzdCwgdGhlcmUncyBubyBuZWVkXHJcbiAgICAgICAgICAgIC8vIHRvIGJhY2tmaWxsIGZvciByZW1vdmVkIGxvZ3MuIEp1c3QgZmV0Y2ggdGhlIGxhc3QgYG1heEJhY2tmaWxsQmxvY2tzYFxyXG4gICAgICAgICAgICAvLyB3b3J0aCBvZiBsb2dzLlxyXG4gICAgICAgICAgICBjb25zdCBsYXN0U2VlbkJsb2NrTnVtYmVyID0gZnJvbUhleChwcmV2aW91c0xvZ3NbcHJldmlvdXNMb2dzLmxlbmd0aCAtIDFdLmJsb2NrTnVtYmVyKTtcclxuICAgICAgICAgICAgY29uc3QgbWluQmxvY2tOdW1iZXIgPSB0b0Jsb2NrTnVtYmVyIC0gdGhpcy5tYXhCYWNrZmlsbEJsb2NrcyArIDE7XHJcbiAgICAgICAgICAgIGlmIChsYXN0U2VlbkJsb2NrTnVtYmVyIDwgbWluQmxvY2tOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldExvZ3NJblJhbmdlKGZpbHRlciwgbWluQmxvY2tOdW1iZXIsIHRvQmxvY2tOdW1iZXIgKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBSZXR1cm4gYWxsIGxvZyBldmVudHMgdGhhdCBoYXZlIGhhcHBlbmVkIGFsb25nIHdpdGggbG9nIGV2ZW50cyB0aGF0IGhhdmVcclxuICAgICAgICAgICAgLy8gYmVlbiByZW1vdmVkIGR1ZSB0byBhIGNoYWluIHJlb3JnLlxyXG4gICAgICAgICAgICBjb25zdCBjb21tb25BbmNlc3RvciA9IHlpZWxkIHRoaXMuZ2V0Q29tbW9uQW5jZXN0b3IoaXNDYW5jZWxsZWQsIHByZXZpb3VzTG9ncyk7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICAvLyBBbGwgcHJldmlvdXMgbG9ncyB3aXRoIGEgYmxvY2sgbnVtYmVyIGdyZWF0ZXIgdGhhbiB0aGUgY29tbW9uIGFuY2VzdG9yXHJcbiAgICAgICAgICAgIC8vIHdlcmUgcGFydCBvZiBhIHJlLW9yZywgc28gbWFyayB0aGVtIGFzIHN1Y2guXHJcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZWRMb2dzID0gcHJldmlvdXNMb2dzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGxvZyA9PiBmcm9tSGV4KGxvZy5ibG9ja051bWJlcikgPiBjb21tb25BbmNlc3Rvci5ibG9ja051bWJlcilcclxuICAgICAgICAgICAgICAgIC5tYXAobG9nID0+IChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGxvZyksIHsgcmVtb3ZlZDogdHJ1ZSB9KSkpO1xyXG4gICAgICAgICAgICAvLyBJZiBubyBjb21tb24gYW5jZXN0b3Igd2FzIGZvdW5kLCBzdGFydCBiYWNrZmlsbCBmcm9tIHRoZSBvbGRlc3QgbG9nJ3NcclxuICAgICAgICAgICAgLy8gYmxvY2sgbnVtYmVyLlxyXG4gICAgICAgICAgICBjb25zdCBmcm9tQmxvY2tJbmNsdXNpdmUgPSBjb21tb25BbmNlc3Rvci5ibG9ja051bWJlciA9PT0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXHJcbiAgICAgICAgICAgICAgICA/IGZyb21IZXgocHJldmlvdXNMb2dzWzBdLmJsb2NrTnVtYmVyKVxyXG4gICAgICAgICAgICAgICAgOiBjb21tb25BbmNlc3Rvci5ibG9ja051bWJlcjtcclxuICAgICAgICAgICAgbGV0IGFkZGVkTG9ncyA9IHlpZWxkIHRoaXMuZ2V0TG9nc0luUmFuZ2UoZmlsdGVyLCBmcm9tQmxvY2tJbmNsdXNpdmUsIHRvQmxvY2tOdW1iZXIgKyAxKTtcclxuICAgICAgICAgICAgLy8gRGUtZHVwZSBhbnkgbG9ncyB0aGF0IHdlcmUgYWxyZWFkeSBlbWl0dGVkLlxyXG4gICAgICAgICAgICBhZGRlZExvZ3MgPSBhZGRlZExvZ3MuZmlsdGVyKGxvZyA9PiBsb2cgJiZcclxuICAgICAgICAgICAgICAgIChmcm9tSGV4KGxvZy5ibG9ja051bWJlcikgPiBjb21tb25BbmNlc3Rvci5ibG9ja051bWJlciB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGZyb21IZXgobG9nLmxvZ0luZGV4KSA+IGNvbW1vbkFuY2VzdG9yLmxvZ0luZGV4KSk7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gWy4uLnJlbW92ZWRMb2dzLCAuLi5hZGRlZExvZ3NdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIGEgbmV3IG1heCBiYWNrZmlsbCBibG9ja3MuIFZJU0lCTEUgT05MWSBGT1IgVEVTVElORy5cclxuICAgICAqXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgc2V0TWF4QmFja2ZpbGxCbG9jayhuZXdNYXgpIHtcclxuICAgICAgICB0aGlzLm1heEJhY2tmaWxsQmxvY2tzID0gbmV3TWF4O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBjdXJyZW50IGJsb2NrIG51bWJlciBhcyBhIG51bWJlci5cclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBnZXRCbG9ja051bWJlcigpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCBibG9ja051bWJlckhleCA9IHlpZWxkIHRoaXMucHJvdmlkZXIuc2VuZCgnZXRoX2Jsb2NrTnVtYmVyJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmcm9tSGV4KGJsb2NrTnVtYmVySGV4KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBhbGwgYG5ld0hlYWRgIGV2ZW50cyBpbiB0aGUgcHJvdmlkZWQgcmFuZ2UuIE5vdGUgdGhhdCB0aGUgcmV0dXJuZWRcclxuICAgICAqIGhlYWRzIGRvIG5vdCBpbmNsdWRlIHJlLW9yZ2VkIGhlYWRzLiBVc2Uge0BsaW5rIGdldFJlb3JnSGVhZHN9IHRvIGZpbmQgaGVhZHNcclxuICAgICAqIHRoYXQgd2VyZSBwYXJ0IG9mIGEgcmUtb3JnLlxyXG4gICAgICpcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGdldEhlYWRFdmVudHNJblJhbmdlKGZyb21CbG9ja0luY2x1c2l2ZSwgdG9CbG9ja0V4Y2x1c2l2ZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChmcm9tQmxvY2tJbmNsdXNpdmUgPj0gdG9CbG9ja0V4Y2x1c2l2ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGJhdGNoUGFydHMgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGZyb21CbG9ja0luY2x1c2l2ZTsgaSA8IHRvQmxvY2tFeGNsdXNpdmU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgYmF0Y2hQYXJ0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdldGhfZ2V0QmxvY2tCeU51bWJlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBbdG9IZXgoaSksIGZhbHNlXVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogaGFuZGxlIGVycm9yc1xyXG4gICAgICAgICAgICBjb25zdCBibG9ja0hlYWRzID0geWllbGQgdGhpcy5wcm92aWRlci5zZW5kQmF0Y2goYmF0Y2hQYXJ0cyk7XHJcbiAgICAgICAgICAgIHJldHVybiBibG9ja0hlYWRzLm1hcCh0b05ld0hlYWRzRXZlbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGFsbCBoZWFkcyB0aGF0IHdlcmUgcGFydCBvZiBhIHJlb3JnIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGdldFJlb3JnSGVhZHMoaXNDYW5jZWxsZWQsIHByZXZpb3VzSGVhZHMpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgLy8gSXRlcmF0ZSBmcm9tIHRoZSBtb3N0IHJlY2VudCBoZWFkIGJhY2t3YXJkcyBpbiBvcmRlciB0byBmaW5kIHRoZSBmaXJzdFxyXG4gICAgICAgICAgICAvLyBibG9jayB0aGF0IHdhcyBwYXJ0IG9mIGEgcmUtb3JnLlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gcHJldmlvdXNIZWFkcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkRXZlbnQgPSBwcmV2aW91c0hlYWRzW2ldO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmxvY2tIZWFkID0geWllbGQgdGhpcy5nZXRCbG9ja0J5TnVtYmVyKGZyb21IZXgob2xkRXZlbnQubnVtYmVyKSk7XHJcbiAgICAgICAgICAgICAgICB0aHJvd0lmQ2FuY2VsbGVkKGlzQ2FuY2VsbGVkKTtcclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBoYXNoZXMgbWF0Y2gsIHRoZW4gY3VycmVudCBoZWFkIGluIHRoZSBpdGVyYXRpb24gd2FzIG5vdCByZS1vcmdlZC5cclxuICAgICAgICAgICAgICAgIGlmIChvbGRFdmVudC5oYXNoID09PSBibG9ja0hlYWQuaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godG9OZXdIZWFkc0V2ZW50KGJsb2NrSGVhZCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQucmV2ZXJzZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgYGV0aF9nZXRCbG9ja0J5TnVtYmVyYCB0aGF0IHJldHVybnMgdGhlIGNvbXBsZXRlXHJcbiAgICAgKiBibG9jayBpbmZvcm1hdGlvbiBmb3IgdGhlIHByb3ZpZGVkIGJsb2NrIG51bWJlci5cclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBnZXRCbG9ja0J5TnVtYmVyKGJsb2NrTnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXIuc2VuZCgnZXRoX2dldEJsb2NrQnlOdW1iZXInLCBbXHJcbiAgICAgICAgICAgICAgICB0b0hleChibG9ja051bWJlciksXHJcbiAgICAgICAgICAgICAgICBmYWxzZVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2l2ZW4gYSBsaXN0IG9mIHByZXZpb3VzIGxvZyBldmVudHMsIGZpbmRzIHRoZSBjb21tb24gYmxvY2sgbnVtYmVyIGZyb20gdGhlXHJcbiAgICAgKiBsb2dzIHRoYXQgbWF0Y2hlcyB0aGUgYmxvY2sgaGVhZC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIGNhbiBiZSB1c2VkIHRvIGlkZW50aWZ5IHdoaWNoIGxvZ3MgYXJlIHBhcnQgb2YgYSByZS1vcmcuXHJcbiAgICAgKlxyXG4gICAgICogUmV0dXJucyAxIGxlc3MgdGhhbiB0aGUgb2xkZXN0IGxvZydzIGJsb2NrIG51bWJlciBpZiBubyBjb21tb24gYW5jZXN0b3Igd2FzIGZvdW5kLlxyXG4gICAgICpcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGdldENvbW1vbkFuY2VzdG9yKGlzQ2FuY2VsbGVkLCBwcmV2aW91c0xvZ3MpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICAvLyBJdGVyYXRlIGZyb20gdGhlIG1vc3QgcmVjZW50IGhlYWQgYmFja3dhcmRzIGluIG9yZGVyIHRvIGZpbmQgdGhlIGZpcnN0XHJcbiAgICAgICAgICAgIC8vIGJsb2NrIHRoYXQgd2FzIHBhcnQgb2YgYSByZS1vcmcuXHJcbiAgICAgICAgICAgIGxldCBibG9ja0hlYWQgPSB5aWVsZCB0aGlzLmdldEJsb2NrQnlOdW1iZXIoZnJvbUhleChwcmV2aW91c0xvZ3NbcHJldmlvdXNMb2dzLmxlbmd0aCAtIDFdLmJsb2NrTnVtYmVyKSk7XHJcbiAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gcHJldmlvdXNMb2dzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRMb2cgPSBwcmV2aW91c0xvZ3NbaV07XHJcbiAgICAgICAgICAgICAgICAvLyBFbnN1cmUgdGhhdCB1cGRhdGVkIGJsb2NrcyBhcmUgZmV0Y2hlZCBldmVyeSB0aW1lIHRoZSBsb2cncyBibG9jayBudW1iZXJcclxuICAgICAgICAgICAgICAgIC8vIGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICBpZiAob2xkTG9nLmJsb2NrTnVtYmVyICE9PSBibG9ja0hlYWQubnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tIZWFkID0geWllbGQgdGhpcy5nZXRCbG9ja0J5TnVtYmVyKGZyb21IZXgob2xkTG9nLmJsb2NrTnVtYmVyKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBTaW5jZSBsb2dzIGFyZSBvcmRlcmVkIGluIGFzY2VuZGluZyBvcmRlciwgdGhlIGZpcnN0IGxvZyB0aGF0IG1hdGNoZXNcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBoYXNoIHNob3VsZCBiZSB0aGUgbGFyZ2VzdCBsb2dJbmRleC5cclxuICAgICAgICAgICAgICAgIGlmIChvbGRMb2cuYmxvY2tIYXNoID09PSBibG9ja0hlYWQuaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrTnVtYmVyOiBmcm9tSGV4KG9sZExvZy5ibG9ja051bWJlciksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0luZGV4OiBmcm9tSGV4KG9sZExvZy5sb2dJbmRleClcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBibG9ja051bWJlcjogTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLFxyXG4gICAgICAgICAgICAgICAgbG9nSW5kZXg6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIGFsbCBgbG9nc2AgZXZlbnRzIGluIHRoZSBwcm92aWRlZCByYW5nZS4gTm90ZSB0aGF0IHRoZSByZXR1cm5lZCBsb2dzXHJcbiAgICAgKiBkbyBub3QgaW5jbHVkZSByZW1vdmVkIGxvZ3MuXHJcbiAgICAgKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqLyBnZXRMb2dzSW5SYW5nZShmaWx0ZXIsIGZyb21CbG9ja0luY2x1c2l2ZSwgdG9CbG9ja0V4Y2x1c2l2ZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChmcm9tQmxvY2tJbmNsdXNpdmUgPj0gdG9CbG9ja0V4Y2x1c2l2ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlRmlsdGVyID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBmaWx0ZXIpLCB7IGZyb21CbG9jazogdG9IZXgoZnJvbUJsb2NrSW5jbHVzaXZlKSwgdG9CbG9jazogdG9IZXgodG9CbG9ja0V4Y2x1c2l2ZSAtIDEpIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm92aWRlci5zZW5kKCdldGhfZ2V0TG9ncycsIFtyYW5nZUZpbHRlcl0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRvTmV3SGVhZHNFdmVudChoZWFkKSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBPYmplY3QuYXNzaWduKHt9LCBoZWFkKTtcclxuICAgIGRlbGV0ZSByZXN1bHQudG90YWxEaWZmaWN1bHR5O1xyXG4gICAgZGVsZXRlIHJlc3VsdC50cmFuc2FjdGlvbnM7XHJcbiAgICBkZWxldGUgcmVzdWx0LnVuY2xlcztcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuZnVuY3Rpb24gZGVkdXBlTmV3SGVhZHMoZXZlbnRzKSB7XHJcbiAgICByZXR1cm4gZGVkdXBlKGV2ZW50cywgZXZlbnQgPT4gZXZlbnQuaGFzaCk7XHJcbn1cclxuZnVuY3Rpb24gZGVkdXBlTG9ncyhldmVudHMpIHtcclxuICAgIHJldHVybiBkZWR1cGUoZXZlbnRzLCBldmVudCA9PiBgJHtldmVudC5ibG9ja0hhc2h9LyR7ZXZlbnQubG9nSW5kZXh9YCk7XHJcbn1cclxuZnVuY3Rpb24gZGVkdXBlKGl0ZW1zLCBnZXRLZXkpIHtcclxuICAgIGNvbnN0IGtleXNTZWVuID0gbmV3IFNldCgpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIGNvbnN0IGtleSA9IGdldEtleShpdGVtKTtcclxuICAgICAgICBpZiAoIWtleXNTZWVuLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgIGtleXNTZWVuLmFkZChrZXkpO1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuY29uc3QgQ0FOQ0VMTEVEID0gbmV3IEVycm9yKCdDYW5jZWxsZWQnKTtcclxuZnVuY3Rpb24gdGhyb3dJZkNhbmNlbGxlZChpc0NhbmNlbGxlZCkge1xyXG4gICAgaWYgKGlzQ2FuY2VsbGVkKCkpIHtcclxuICAgICAgICB0aHJvdyBDQU5DRUxMRUQ7XHJcbiAgICB9XHJcbn1cblxuY29uc3QgSEVBUlRCRUFUX0lOVEVSVkFMID0gMzAwMDA7XHJcbmNvbnN0IEhFQVJUQkVBVF9XQUlUX1RJTUUgPSAxMDAwMDtcclxuY29uc3QgQkFDS0ZJTExfVElNRU9VVCA9IDYwMDAwO1xyXG5jb25zdCBCQUNLRklMTF9SRVRSSUVTID0gNTtcclxuLyoqXHJcbiAqIFN1YnNjcmlwdGlvbnMgaGF2ZSBhIG1lbW9yeSBvZiByZWNlbnQgZXZlbnRzIHRoZXkgaGF2ZSBzZW50IHNvIHRoYXQgaW4gdGhlXHJcbiAqIGV2ZW50IHRoYXQgdGhleSBkaXNjb25uZWN0IGFuZCBuZWVkIHRvIGJhY2tmaWxsLCB0aGV5IGNhbiBkZXRlY3QgcmUtb3Jncy5cclxuICogS2VlcCBhIGJ1ZmZlciB0aGF0IGdvZXMgYmFjayBhdCBsZWFzdCB0aGVzZSBtYW55IGJsb2NrcywgdGhlIG1heGltdW0gYW1vdW50XHJcbiAqIGF0IHdoaWNoIHdlIG1pZ2h0IGNvbmNlaXZhYmx5IHNlZSBhIHJlLW9yZy5cclxuICpcclxuICogTm90ZSB0aGF0IHdoaWxlIG91ciBidWZmZXIgZ29lcyBiYWNrIHRoaXMgbWFueSBibG9ja3MsIGl0IG1heSBjb250YWluIG1vcmVcclxuICogdGhhbiB0aGlzIG1hbnkgZWxlbWVudHMsIHNpbmNlIGluIHRoZSBjYXNlIG9mIGxvZ3Mgc3Vic2NyaXB0aW9ucyBtb3JlIHRoYW5cclxuICogb25lIGV2ZW50IG1heSBiZSBlbWl0dGVkIGZvciBhIGJsb2NrLlxyXG4gKi9cclxuY29uc3QgUkVUQUlORURfRVZFTlRfQkxPQ0tfQ09VTlQgPSAxMDtcclxuLyoqXHJcbiAqIFNESydzIGN1c3RvbSBpbXBsZW1lbnRhdGlvbiBmbyB0aGUgZXRoZXJzLmpzJ3MgJ0FsY2hlbXlXZWJTb2NrZXRQcm92aWRlcicuXHJcbiAqXHJcbiAqIERvIG5vdCBjYWxsIHRoaXMgY29uc3RydWN0b3IgZGlyZWN0bHkuIEluc3RlYWQsIGluc3RhbnRpYXRlIGFuIGluc3RhbmNlIG9mXHJcbiAqIHtAbGluayBBbGNoZW15fSBhbmQgY2FsbCB7QGxpbmsgQWxjaGVteS5jb25maWcuZ2V0V2ViU29ja2V0UHJvdmlkZXIoKX0uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEFsY2hlbXlXZWJTb2NrZXRQcm92aWRlciBleHRlbmRzIFdlYlNvY2tldFByb3ZpZGVyIHtcclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgd3NDb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAvLyBOb3JtYWxpemUgdGhlIEFQSSBLZXkgdG8gYSBzdHJpbmcuXHJcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gQWxjaGVteVByb3ZpZGVyLmdldEFwaUtleShjb25maWcuYXBpS2V5KTtcclxuICAgICAgICAvLyBHZW5lcmF0ZSBvdXIgb3duIGNvbm5lY3Rpb24gaW5mbyB3aXRoIHRoZSBjb3JyZWN0IGVuZHBvaW50IFVSTHMuXHJcbiAgICAgICAgY29uc3QgYWxjaGVteU5ldHdvcmsgPSBBbGNoZW15UHJvdmlkZXIuZ2V0QWxjaGVteU5ldHdvcmsoY29uZmlnLm5ldHdvcmspO1xyXG4gICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBBbGNoZW15UHJvdmlkZXIuZ2V0QWxjaGVteUNvbm5lY3Rpb25JbmZvKGFsY2hlbXlOZXR3b3JrLCBhcGlLZXksICd3c3MnKTtcclxuICAgICAgICBjb25zdCBwcm90b2NvbCA9IGBhbGNoZW15LXNkay0ke1ZFUlNJT059YDtcclxuICAgICAgICAvLyBVc2UgdGhlIHByb3ZpZGVkIGNvbmZpZyBVUkwgb3ZlcnJpZGUgaWYgaXQgZXhpc3RzLCBvdGhlcndpc2UgdXNlIHRoZSBjcmVhdGVkIG9uZS5cclxuICAgICAgICBjb25zdCB3cyA9IG5ldyBTdHVyZHlXZWJTb2NrZXQoKF9hID0gY29uZmlnLnVybCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogY29ubmVjdGlvbi51cmwsIHByb3RvY29sLCB7XHJcbiAgICAgICAgICAgIHdzQ29uc3RydWN0b3I6IHdzQ29uc3RydWN0b3IgIT09IG51bGwgJiYgd3NDb25zdHJ1Y3RvciAhPT0gdm9pZCAwID8gd3NDb25zdHJ1Y3RvciA6IGdldFdlYnNvY2tldENvbnN0cnVjdG9yKClcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBOb3JtYWxpemUgdGhlIEFsY2hlbXkgbmFtZWQgbmV0d29yayBpbnB1dCB0byB0aGUgbmV0d29yayBuYW1lcyB1c2VkIGJ5XHJcbiAgICAgICAgLy8gZXRoZXJzLiBUaGlzIGFsbG93cyB0aGUgcGFyZW50IHN1cGVyIGNvbnN0cnVjdG9yIGluIEpzb25ScGNQcm92aWRlciB0b1xyXG4gICAgICAgIC8vIGNvcnJlY3RseSBzZXQgdGhlIG5ldHdvcmsuXHJcbiAgICAgICAgY29uc3QgZXRoZXJzTmV0d29yayA9IEV0aGVyc05ldHdvcmtbYWxjaGVteU5ldHdvcmtdO1xyXG4gICAgICAgIHN1cGVyKHdzLCBldGhlcnNOZXR3b3JrKTtcclxuICAgICAgICB0aGlzLl9ldmVudHMgPSBbXTtcclxuICAgICAgICAvLyBJbiB0aGUgY2FzZSBvZiBhIFdlYlNvY2tldCByZWNvbm5lY3Rpb24sIGFsbCBzdWJzY3JpcHRpb25zIGFyZSBsb3N0IGFuZCB3ZVxyXG4gICAgICAgIC8vIGNyZWF0ZSBuZXcgb25lcyB0byByZXBsYWNlIHRoZW0sIGJ1dCB3ZSB3YW50IHRvIGNyZWF0ZSB0aGUgaWxsdXNpb24gdGhhdFxyXG4gICAgICAgIC8vIHRoZSBvcmlnaW5hbCBzdWJzY3JpcHRpb25zIHBlcnNpc3QuIFRodXMsIG1haW50YWluIGEgbWFwcGluZyBmcm9tIHRoZVxyXG4gICAgICAgIC8vIFwidmlydHVhbFwiIHN1YnNjcmlwdGlvbiBpZHMgd2hpY2ggYXJlIHZpc2libGUgdG8gdGhlIGNvbnN1bWVyIHRvIHRoZVxyXG4gICAgICAgIC8vIFwicGh5c2ljYWxcIiBzdWJzY3JpcHRpb24gaWRzIG9mIHRoZSBhY3R1YWwgY29ubmVjdGlvbnMuIFRoaXMgdGVybWlub2xvZ3kgaXNcclxuICAgICAgICAvLyBib3Jyb3dlZCBmcm9tIHZpcnR1YWwgYW5kIHBoeXNpY2FsIG1lbW9yeSwgd2hpY2ggaGFzIGEgc2ltaWxhciBtYXBwaW5nLlxyXG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgICAgICB0aGlzLnZpcnR1YWxTdWJzY3JpcHRpb25zQnlJZCA9IG5ldyBNYXAoKTtcclxuICAgICAgICAvKiogQGludGVybmFsICovXHJcbiAgICAgICAgdGhpcy52aXJ0dWFsSWRzQnlQaHlzaWNhbElkID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSB1bmRlcmx5aW5nIGV0aGVycyB7QGxpbmsgV2ViU29ja2V0UHJvdmlkZXJ9IGFscmVhZHkgaGFuZGxlcyBhbmQgZW1pdHNcclxuICAgICAgICAgKiBtZXNzYWdlcy4gVG8gYWxsb3cgYmFja2ZpbGxpbmcsIHRyYWNrIGFsbCBtZXNzYWdlcyB0aGF0IGFyZSBlbWl0dGVkLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogVGhpcyBpcyBhIGZpZWxkIGFycm93IGZ1bmN0aW9uIGluIG9yZGVyIHRvIHByZXNlcnZlIGB0aGlzYCBjb250ZXh0IHdoZW5cclxuICAgICAgICAgKiBwYXNzaW5nIHRoZSBtZXRob2QgYXMgYW4gZXZlbnQgbGlzdGVuZXIuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAaW50ZXJuYWxcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmhhbmRsZU1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcbiAgICAgICAgICAgIGlmICghaXNTdWJzY3JpcHRpb25FdmVudChtZXNzYWdlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHBoeXNpY2FsSWQgPSBtZXNzYWdlLnBhcmFtcy5zdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgIGNvbnN0IHZpcnR1YWxJZCA9IHRoaXMudmlydHVhbElkc0J5UGh5c2ljYWxJZC5nZXQocGh5c2ljYWxJZCk7XHJcbiAgICAgICAgICAgIGlmICghdmlydHVhbElkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy52aXJ0dWFsU3Vic2NyaXB0aW9uc0J5SWQuZ2V0KHZpcnR1YWxJZCk7XHJcbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24ubWV0aG9kICE9PSAnZXRoX3N1YnNjcmliZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzd2l0Y2ggKHN1YnNjcmlwdGlvbi5wYXJhbXNbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ25ld0hlYWRzJzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0hlYWRzU3Vic2NyaXB0aW9uID0gc3Vic2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0hlYWRzTWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBpc0JhY2tmaWxsaW5nLCBiYWNrZmlsbEJ1ZmZlciB9ID0gbmV3SGVhZHNTdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyByZXN1bHQgfSA9IG5ld0hlYWRzTWVzc2FnZS5wYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQmFja2ZpbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9OZXdIZWFkc0V2ZW50c0J1ZmZlcihiYWNrZmlsbEJ1ZmZlciwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGh5c2ljYWxJZCAhPT0gdmlydHVhbElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIHRoZSBjYXNlIG9mIGEgcmUtb3BlbmVkIHN1YnNjcmlwdGlvbiwgZXRoZXJzIHdpbGwgbm90IGVtaXQgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV2ZW50LCBzbyB0aGUgU0RLIGhhcyB0by5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0QW5kUmVtZW1iZXJFdmVudCh2aXJ0dWFsSWQsIHJlc3VsdCwgZ2V0TmV3SGVhZHNCbG9ja051bWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFdGhlcnMgc3Vic2NyaXB0aW9uIG1hcHBpbmcgd2lsbCBlbWl0IHRoZSBldmVudCwganVzdCBzdG9yZSBpdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1lbWJlckV2ZW50KHZpcnR1YWxJZCwgcmVzdWx0LCBnZXROZXdIZWFkc0Jsb2NrTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsb2dzJzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxvZ3NTdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9nc01lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgaXNCYWNrZmlsbGluZywgYmFja2ZpbGxCdWZmZXIgfSA9IGxvZ3NTdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyByZXN1bHQgfSA9IGxvZ3NNZXNzYWdlLnBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNCYWNrZmlsbGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRUb0xvZ3NFdmVudHNCdWZmZXIoYmFja2ZpbGxCdWZmZXIsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZpcnR1YWxJZCAhPT0gcGh5c2ljYWxJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRBbmRSZW1lbWJlckV2ZW50KHZpcnR1YWxJZCwgcmVzdWx0LCBnZXRMb2dzQmxvY2tOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1lbWJlckV2ZW50KHZpcnR1YWxJZCwgcmVzdWx0LCBnZXRMb2dzQmxvY2tOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBoeXNpY2FsSWQgIT09IHZpcnR1YWxJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiB0aGUgY2FzZSBvZiBhIHJlLW9wZW5lZCBzdWJzY3JpcHRpb24sIGV0aGVycyB3aWxsIG5vdCBlbWl0IHRoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBldmVudCwgc28gdGhlIFNESyBoYXMgdG8uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSBtZXNzYWdlLnBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQodmlydHVhbElkLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hlbiB0aGUgd2Vic29ja2V0IGNvbm5lY3Rpb24gcmVvcGVuczpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIDEuIFJlc3Vic2NyaWJlIHRvIGFsbCBleGlzdGluZyBzdWJzY3JpcHRpb25zIGFuZCBzdGFydCBiYWNrZmlsbGluZ1xyXG4gICAgICAgICAqIDIuIFJlc3RhcnQgaGVhcnQgYmVhdC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFRoaXMgaXMgYSBmaWVsZCBhcnJvdyBmdW5jdGlvbiBpbiBvcmRlciB0byBwcmVzZXJ2ZSBgdGhpc2AgY29udGV4dCB3aGVuXHJcbiAgICAgICAgICogcGFzc2luZyB0aGUgbWV0aG9kIGFzIGFuIGV2ZW50IGxpc3RlbmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGludGVybmFsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5oYW5kbGVSZW9wZW4gPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmlydHVhbElkc0J5UGh5c2ljYWxJZC5jbGVhcigpO1xyXG4gICAgICAgICAgICBjb25zdCB7IGNhbmNlbCwgaXNDYW5jZWxsZWQgfSA9IG1ha2VDYW5jZWxUb2tlbigpO1xyXG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJhY2tmaWxsID0gY2FuY2VsO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHN1YnNjcmlwdGlvbiBvZiB0aGlzLnZpcnR1YWxTdWJzY3JpcHRpb25zQnlJZC52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgdm9pZCAoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucmVzdWJzY3JpYmVBbmRCYWNrZmlsbChpc0NhbmNlbGxlZCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNDYW5jZWxsZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3Igd2hpbGUgYmFja2ZpbGxpbmcgXCIke3N1YnNjcmlwdGlvbi5wYXJhbXNbMF19XCIgc3Vic2NyaXB0aW9uLiBTb21lIGV2ZW50cyBtYXkgYmUgbWlzc2luZy5gLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0SGVhcnRiZWF0KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYW5jZWxzIHRoZSBoZWFydGJlYXQgYW5kIGFueSBwZW5kaW5nIGJhY2tmaWxscyBiZWluZyBwZXJmb3JtZWQuIFRoaXMgaXNcclxuICAgICAgICAgKiBjYWxsZWQgd2hlbiB0aGUgd2Vic29ja2V0IGNvbm5lY3Rpb24gZ29lcyBkb3duIG9yIGlzIGRpc2Nvbm5lY3RlZC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFRoaXMgaXMgYSBmaWVsZCBhcnJvdyBmdW5jdGlvbiBpbiBvcmRlciB0byBwcmVzZXJ2ZSBgdGhpc2AgY29udGV4dCB3aGVuXHJcbiAgICAgICAgICogcGFzc2luZyB0aGUgbWV0aG9kIGFzIGFuIGV2ZW50IGxpc3RlbmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGludGVybmFsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zdG9wSGVhcnRiZWF0QW5kQmFja2ZpbGwgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhlYXJ0YmVhdEludGVydmFsSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmhlYXJ0YmVhdEludGVydmFsSWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWFydGJlYXRJbnRlcnZhbElkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2FuY2VsQmFja2ZpbGwoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xyXG4gICAgICAgIC8vIFN0YXJ0IGhlYXJ0YmVhdCBhbmQgYmFja2ZpbGxlciBmb3IgdGhlIHdlYnNvY2tldCBjb25uZWN0aW9uLlxyXG4gICAgICAgIHRoaXMuYmFja2ZpbGxlciA9IG5ldyBXZWJzb2NrZXRCYWNrZmlsbGVyKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYWRkU29ja2V0TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5zdGFydEhlYXJ0YmVhdCgpO1xyXG4gICAgICAgIHRoaXMuY2FuY2VsQmFja2ZpbGwgPSBub29wO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZXMgdGhlIGBCYXNlUHJvdmlkZXIuZ2V0TmV0d29ya2AgbWV0aG9kIGFzIGltcGxlbWVudGVkIGJ5IGV0aGVycy5qcy5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG92ZXJyaWRlIGFsbG93cyB0aGUgU0RLIHRvIHNldCB0aGUgcHJvdmlkZXIncyBuZXR3b3JrIHRvIHZhbHVlcyBub3RcclxuICAgICAqIHlldCBzdXBwb3J0ZWQgYnkgZXRoZXJzLmpzLlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBnZXROZXR3b3JrKG5ldHdvcmspIHtcclxuICAgICAgICBpZiAodHlwZW9mIG5ldHdvcmsgPT09ICdzdHJpbmcnICYmIG5ldHdvcmsgaW4gQ3VzdG9tTmV0d29ya3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEN1c3RvbU5ldHdvcmtzW25ldHdvcmtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDYWxsIHRoZSBzdGFuZGFyZCBldGhlcnMuanMgZ2V0TmV0d29yayBtZXRob2QgZm9yIG90aGVyIG5ldHdvcmtzLlxyXG4gICAgICAgIHJldHVybiBnZXROZXR3b3JrKG5ldHdvcmspO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZGVuIGltcGxlbWVudGF0aW9uIG9mIGV0aGVycyB0aGF0IGluY2x1ZGVzIEFsY2hlbXkgYmFzZWQgc3Vic2NyaXB0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lIEV2ZW50IHRvIHN1YnNjcmliZSB0b1xyXG4gICAgICogQHBhcmFtIGxpc3RlbmVyIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGV2ZW50IGlzIHRyaWdnZXJlZC5cclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICovXHJcbiAgICAvLyBUT0RPOiBPdmVycmlkZSBgTGlzdGVuZXJgIHR5cGUgdG8gZ2V0IHR5cGUgYXV0b2NvbXBsZXRpb25zLlxyXG4gICAgb24oZXZlbnROYW1lLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIsIGZhbHNlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3ZlcnJpZGRlbiBpbXBsZW1lbnRhdGlvbiBvZiBldGhlcnMgdGhhdCBpbmNsdWRlcyBBbGNoZW15IGJhc2VkXHJcbiAgICAgKiBzdWJzY3JpcHRpb25zLiBBZGRzIGEgbGlzdGVuZXIgdG8gdGhlIHRyaWdnZXJlZCBmb3Igb25seSB0aGUgbmV4dFxyXG4gICAgICoge0BsaW5rIGV2ZW50TmFtZX0gZXZlbnQsIGFmdGVyIHdoaWNoIGl0IHdpbGwgYmUgcmVtb3ZlZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lIEV2ZW50IHRvIHN1YnNjcmliZSB0b1xyXG4gICAgICogQHBhcmFtIGxpc3RlbmVyIFRoZSBsaXN0ZW5lciBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGV2ZW50IGlzIHRyaWdnZXJlZC5cclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICovXHJcbiAgICAvLyBUT0RPOiBPdmVycmlkZSBgTGlzdGVuZXJgIHR5cGUgdG8gZ2V0IHR5cGUgYXV0b2NvbXBsZXRpb25zLlxyXG4gICAgb25jZShldmVudE5hbWUsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lciwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdGhlIHByb3ZpZGVkIHtAbGluayBsaXN0ZW5lcn0gZm9yIHRoZSB7QGxpbmsgZXZlbnROYW1lfSBldmVudC4gSWYgbm9cclxuICAgICAqIGxpc3RlbmVyIGlzIHByb3ZpZGVkLCBhbGwgbGlzdGVuZXJzIGZvciB0aGUgZXZlbnQgd2lsbCBiZSByZW1vdmVkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudE5hbWUgRXZlbnQgdG8gdW5saXN0ZW4gdG8uXHJcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXIgVGhlIGxpc3RlbmVyIGZ1bmN0aW9uIHRvIHJlbW92ZS5cclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICovXHJcbiAgICBvZmYoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmIChpc0FsY2hlbXlFdmVudChldmVudE5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vZmYoZXZlbnROYW1lLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIub2ZmKGV2ZW50TmFtZSwgbGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGFsbCBsaXN0ZW5lcnMgZm9yIHRoZSBwcm92aWRlZCB7QGxpbmsgZXZlbnROYW1lfSBldmVudC4gSWYgbm8gZXZlbnRcclxuICAgICAqIGlzIHByb3ZpZGVkLCBhbGwgZXZlbnRzIGFuZCB0aGVpciBsaXN0ZW5lcnMgYXJlIHJlbW92ZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZSBUaGUgZXZlbnQgdG8gcmVtb3ZlIGFsbCBsaXN0ZW5lcnMgZm9yLlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKiBAcHVibGljXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUFsbExpc3RlbmVycyhldmVudE5hbWUpIHtcclxuICAgICAgICBpZiAoZXZlbnROYW1lICE9PSB1bmRlZmluZWQgJiYgaXNBbGNoZW15RXZlbnQoZXZlbnROYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIucmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgbGlzdGVuZXJzIGZvciB0aGUgcHJvdmlkZWQge0BsaW5rIGV2ZW50TmFtZX0gZXZlbnQuIElmXHJcbiAgICAgKiBubyBldmVudCBpcyBwcm92aWRlZCwgdGhlIHRvdGFsIG51bWJlciBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudHMgaXMgcmV0dXJuZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZSBUaGUgZXZlbnQgdG8gZ2V0IHRoZSBudW1iZXIgb2YgbGlzdGVuZXJzIGZvci5cclxuICAgICAqIEBwdWJsaWNcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBsaXN0ZW5lckNvdW50KGV2ZW50TmFtZSkge1xyXG4gICAgICAgIGlmIChldmVudE5hbWUgIT09IHVuZGVmaW5lZCAmJiBpc0FsY2hlbXlFdmVudChldmVudE5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0ZW5lckNvdW50KGV2ZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIubGlzdGVuZXJDb3VudChldmVudE5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBsaXN0ZW5lcnMgZm9yIHRoZSBwcm92aWRlZCB7QGxpbmsgZXZlbnROYW1lfSBldmVudC4gSWZcclxuICAgICAqIG5vIGV2ZW50IGlzIHByb3ZpZGVkLCBhbGwgbGlzdGVuZXJzIHdpbGwgYmUgaW5jbHVkZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZSBUaGUgZXZlbnQgdG8gZ2V0IHRoZSBsaXN0ZW5lcnMgZm9yLlxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGxpc3RlbmVycyhldmVudE5hbWUpIHtcclxuICAgICAgICBpZiAoZXZlbnROYW1lICE9PSB1bmRlZmluZWQgJiYgaXNBbGNoZW15RXZlbnQoZXZlbnROYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdGVuZXJzKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIubGlzdGVuZXJzKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZXMgdGhlIG1ldGhvZCBpbiBgQmFzZVByb3ZpZGVyYCBpbiBvcmRlciB0byBwcm9wZXJseSBmb3JtYXQgdGhlXHJcbiAgICAgKiBBbGNoZW15IHN1YnNjcmlwdGlvbiBldmVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgX2FkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lciwgb25jZSkge1xyXG4gICAgICAgIGlmIChpc0FsY2hlbXlFdmVudChldmVudE5hbWUpKSB7XHJcbiAgICAgICAgICAgIHZlcmlmeUFsY2hlbXlFdmVudE5hbWUoZXZlbnROYW1lKTtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXRoZXJzRXZlbnQoZ2V0QWxjaGVteUV2ZW50VGFnKGV2ZW50TmFtZSksIGxpc3RlbmVyLCBvbmNlKTtcclxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzLnB1c2goZXZlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFydEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuX2FkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lciwgb25jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZXMgdGhlIGBfc3RhcnRFdmVudCgpYCBtZXRob2QgaW4gZXRoZXJzLmpzJ3NcclxuICAgICAqIHtAbGluayBXZWJTb2NrZXRQcm92aWRlcn0gdG8gaW5jbHVkZSBhZGRpdGlvbmFsIGFsY2hlbXkgbWV0aG9kcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9zdGFydEV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGV2ZW50IHR5cGUgaXMgYSBjdXN0b20gQWxjaGVteSBzdWJzY3JpcHRpb24uXHJcbiAgICAgICAgY29uc3QgY3VzdG9tTG9naWNUeXBlcyA9IFsuLi5BTENIRU1ZX0VWRU5UX1RZUEVTLCAnYmxvY2snLCAnZmlsdGVyJ107XHJcbiAgICAgICAgaWYgKGN1c3RvbUxvZ2ljVHlwZXMuaW5jbHVkZXMoZXZlbnQudHlwZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXN0b21TdGFydEV2ZW50KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN1cGVyLl9zdGFydEV2ZW50KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRkZW4gZnJvbSBldGhlcnMuanMncyB7QGxpbmsgV2ViU29ja2V0UHJvdmlkZXJ9XHJcbiAgICAgKlxyXG4gICAgICogTW9kaWZpZWQgaW4gb3JkZXIgdG8gYWRkIG1hcHBpbmdzIGZvciBiYWNrZmlsbGluZy5cclxuICAgICAqXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfc3Vic2NyaWJlKHRhZywgcGFyYW0sIHByb2Nlc3NGdW5jLCBldmVudCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGxldCBzdWJJZFByb21pc2UgPSB0aGlzLl9zdWJJZHNbdGFnXTtcclxuICAgICAgICAgICAgLy8gQkVHSU4gTU9ESUZJRUQgQ09ERVxyXG4gICAgICAgICAgICBjb25zdCBzdGFydGluZ0Jsb2NrTnVtYmVyID0geWllbGQgdGhpcy5nZXRCbG9ja051bWJlcigpO1xyXG4gICAgICAgICAgICAvLyBFTkQgTU9ESUZJRUQgQ09ERVxyXG4gICAgICAgICAgICBpZiAoc3ViSWRQcm9taXNlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHN1YklkUHJvbWlzZSA9IFByb21pc2UuYWxsKHBhcmFtKS50aGVuKHBhcmFtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kKCdldGhfc3Vic2NyaWJlJywgcGFyYW0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdWJJZHNbdGFnXSA9IHN1YklkUHJvbWlzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzdWJJZCA9IHlpZWxkIHN1YklkUHJvbWlzZTtcclxuICAgICAgICAgICAgLy8gQkVHSU4gTU9ESUZJRUQgQ09ERVxyXG4gICAgICAgICAgICBjb25zdCByZXNvbHZlZFBhcmFtcyA9IHlpZWxkIFByb21pc2UuYWxsKHBhcmFtKTtcclxuICAgICAgICAgICAgdGhpcy52aXJ0dWFsU3Vic2NyaXB0aW9uc0J5SWQuc2V0KHN1YklkLCB7XHJcbiAgICAgICAgICAgICAgICBldmVudDogZXZlbnQsXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdldGhfc3Vic2NyaWJlJyxcclxuICAgICAgICAgICAgICAgIHBhcmFtczogcmVzb2x2ZWRQYXJhbXMsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ0Jsb2NrTnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgdmlydHVhbElkOiBzdWJJZCxcclxuICAgICAgICAgICAgICAgIHBoeXNpY2FsSWQ6IHN1YklkLFxyXG4gICAgICAgICAgICAgICAgc2VudEV2ZW50czogW10sXHJcbiAgICAgICAgICAgICAgICBpc0JhY2tmaWxsaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGJhY2tmaWxsQnVmZmVyOiBbXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy52aXJ0dWFsSWRzQnlQaHlzaWNhbElkLnNldChzdWJJZCwgc3ViSWQpO1xyXG4gICAgICAgICAgICAvLyBFTkQgTU9ESUZJRUQgQ09ERVxyXG4gICAgICAgICAgICB0aGlzLl9zdWJzW3N1YklkXSA9IHsgdGFnLCBwcm9jZXNzRnVuYyB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBETyBOT1QgTU9ESUZZLlxyXG4gICAgICpcclxuICAgICAqIE9yaWdpbmFsIGNvZGUgY29waWVkIG92ZXIgZnJvbSBldGhlci5qcydzIGBCYXNlUHJvdmlkZXJgLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGNvcGllZCBvdmVyIGRpcmVjdGx5IGluIG9yZGVyIHRvIGltcGxlbWVudCBBbGNoZW15J3MgdW5pcXVlXHJcbiAgICAgKiBzdWJzY3JpcHRpb24gdHlwZXMuIFRoZSBvbmx5IGRpZmZlcmVuY2UgaXMgdGhhdCB0aGlzIG1ldGhvZCBjYWxsc1xyXG4gICAgICoge0BsaW5rIGdldEFsY2hlbXlFdmVudFRhZ30gaW5zdGVhZCBvZiB0aGUgb3JpZ2luYWwgYGdldEV2ZW50VGFnKClgIG1ldGhvZCBpblxyXG4gICAgICogb3JkZXIgdG8gcGFyc2UgdGhlIEFsY2hlbXkgc3Vic2NyaXB0aW9uIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGVtaXQoZXZlbnROYW1lLCAuLi5hcmdzKSB7XHJcbiAgICAgICAgaWYgKGlzQWxjaGVteUV2ZW50KGV2ZW50TmFtZSkpIHtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCBzdG9wcGVkID0gW107XHJcbiAgICAgICAgICAgIC8vIFRoaXMgbGluZSBpcyB0aGUgb25seSBtb2RpZmllZCBsaW5lIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZC5cclxuICAgICAgICAgICAgY29uc3QgZXZlbnRUYWcgPSBnZXRBbGNoZW15RXZlbnRUYWcoZXZlbnROYW1lKTtcclxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzLmZpbHRlcihldmVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFnICE9PSBldmVudFRhZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQubGlzdGVuZXIuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQub25jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3BwZWQucHVzaChldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBzdG9wcGVkLmZvckVhY2goZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RvcEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZW1pdChldmVudE5hbWUsIC4uLmFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHNlbmRCYXRjaChwYXJ0cykge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGxldCBuZXh0SWQgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gcGFydHMubWFwKCh7IG1ldGhvZCwgcGFyYW1zIH0pID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcyxcclxuICAgICAgICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcclxuICAgICAgICAgICAgICAgICAgICBpZDogYGFsY2hlbXktc2RrOiR7bmV4dElkKyt9YFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbmRCYXRjaENvbmN1cnJlbnRseShwYXlsb2FkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVTb2NrZXRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLnN0b3BIZWFydGJlYXRBbmRCYWNrZmlsbCgpO1xyXG4gICAgICAgIHJldHVybiBzdXBlci5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlcyB0aGUgZXRoZXIncyBgaXNDb21tdW5pdHlSZXNvdXJjZSgpYCBtZXRob2QuIFJldHVybnMgdHJ1ZSBpZiB0aGVcclxuICAgICAqIGN1cnJlbnQgYXBpIGtleSBpcyB0aGUgZGVmYXVsdCBrZXkuXHJcbiAgICAgKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGlzQ29tbXVuaXR5UmVzb3VyY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpS2V5ID09PSBERUZBVUxUX0FMQ0hFTVlfQVBJX0tFWTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRE8gTk9UIE1PRElGWS5cclxuICAgICAqXHJcbiAgICAgKiBPcmlnaW5hbCBjb2RlIGNvcGllZCBvdmVyIGZyb20gZXRoZXIuanMncyBgV2ViU29ja2V0UHJvdmlkZXIuX3N0b3BFdmVudCgpYC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBjb3BpZWQgb3ZlciBkaXJlY3RseSBpbiBvcmRlciB0byBzdXBwb3J0IEFsY2hlbXknc1xyXG4gICAgICogc3Vic2NyaXB0aW9uIHR5cGUgYnkgYWxsb3dpbmcgdGhlIHByb3ZpZGVyIHRvIHByb3Blcmx5IHN0b3AgQWxjaGVteSdzXHJcbiAgICAgKiBzdWJzY3JpcHRpb24gZXZlbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBfc3RvcEV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHRhZyA9IGV2ZW50LnRhZztcclxuICAgICAgICAvLyBTVEFSVCBNT0RJRklFRCBDT0RFXHJcbiAgICAgICAgaWYgKEFMQ0hFTVlfRVZFTlRfVFlQRVMuaW5jbHVkZXMoZXZlbnQudHlwZSkpIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHJlbWFpbmluZyBwZW5kaW5nIHRyYW5zYWN0aW9uIGxpc3RlbmVycy5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2V2ZW50cy5maWx0ZXIoZSA9PiBBTENIRU1ZX0VWRU5UX1RZUEVTLmluY2x1ZGVzKGUudHlwZSkpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEVORCBNT0RJRklFRCBDT0RFXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09ICd0eCcpIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHJlbWFpbmluZyB0cmFuc2FjdGlvbiBldmVudCBsaXN0ZW5lcnNcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2V2ZW50cy5maWx0ZXIoZSA9PiBlLnR5cGUgPT09ICd0eCcpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhZyA9ICd0eCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMubGlzdGVuZXJDb3VudChldmVudC5ldmVudCkpIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHJlbWFpbmluZyBldmVudCBsaXN0ZW5lcnNcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzdWJJZCA9IHRoaXMuX3N1Yklkc1t0YWddO1xyXG4gICAgICAgIGlmICghc3ViSWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWxldGUgdGhpcy5fc3ViSWRzW3RhZ107XHJcbiAgICAgICAgdm9pZCBzdWJJZC50aGVuKHN1YklkID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9zdWJzW3N1YklkXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9zdWJzW3N1YklkXTtcclxuICAgICAgICAgICAgdm9pZCB0aGlzLnNlbmQoJ2V0aF91bnN1YnNjcmliZScsIFtzdWJJZF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgYWRkU29ja2V0TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3dlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5oYW5kbGVNZXNzYWdlKTtcclxuICAgICAgICB0aGlzLl93ZWJzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcigncmVvcGVuJywgdGhpcy5oYW5kbGVSZW9wZW4pO1xyXG4gICAgICAgIHRoaXMuX3dlYnNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdkb3duJywgdGhpcy5zdG9wSGVhcnRiZWF0QW5kQmFja2ZpbGwpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgcmVtb3ZlU29ja2V0TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3dlYnNvY2tldC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5oYW5kbGVNZXNzYWdlKTtcclxuICAgICAgICB0aGlzLl93ZWJzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVvcGVuJywgdGhpcy5oYW5kbGVSZW9wZW4pO1xyXG4gICAgICAgIHRoaXMuX3dlYnNvY2tldC5yZW1vdmVFdmVudExpc3RlbmVyKCdkb3duJywgdGhpcy5zdG9wSGVhcnRiZWF0QW5kQmFja2ZpbGwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW9wZW5zIHRoZSBiYWNrZmlsbCBiYXNlZCBvblxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpc0NhbmNlbGxlZFxyXG4gICAgICogQHBhcmFtIHN1YnNjcmlwdGlvblxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIHJlc3Vic2NyaWJlQW5kQmFja2ZpbGwoaXNDYW5jZWxsZWQsIHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdmlydHVhbElkLCBtZXRob2QsIHBhcmFtcywgc2VudEV2ZW50cywgYmFja2ZpbGxCdWZmZXIsIHN0YXJ0aW5nQmxvY2tOdW1iZXIgfSA9IHN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uLmlzQmFja2ZpbGxpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBiYWNrZmlsbEJ1ZmZlci5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGh5c2ljYWxJZCA9IHlpZWxkIHRoaXMuc2VuZChtZXRob2QsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB0aHJvd0lmQ2FuY2VsbGVkKGlzQ2FuY2VsbGVkKTtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5waHlzaWNhbElkID0gcGh5c2ljYWxJZDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlydHVhbElkc0J5UGh5c2ljYWxJZC5zZXQocGh5c2ljYWxJZCwgdmlydHVhbElkKTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyYW1zWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbmV3SGVhZHMnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tmaWxsRXZlbnRzID0geWllbGQgd2l0aEJhY2tvZmZSZXRyaWVzKCgpID0+IHdpdGhUaW1lb3V0KHRoaXMuYmFja2ZpbGxlci5nZXROZXdIZWFkc0JhY2tmaWxsKGlzQ2FuY2VsbGVkLCBzZW50RXZlbnRzLCBzdGFydGluZ0Jsb2NrTnVtYmVyKSwgQkFDS0ZJTExfVElNRU9VVCksIEJBQ0tGSUxMX1JFVFJJRVMsICgpID0+ICFpc0NhbmNlbGxlZCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3dJZkNhbmNlbGxlZChpc0NhbmNlbGxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ZW50cyA9IGRlZHVwZU5ld0hlYWRzKFsuLi5iYWNrZmlsbEV2ZW50cywgLi4uYmFja2ZpbGxCdWZmZXJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzLmZvckVhY2goZXZlbnQgPT4gdGhpcy5lbWl0TmV3SGVhZHNFdmVudCh2aXJ0dWFsSWQsIGV2ZW50KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdsb2dzJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXIgPSBwYXJhbXNbMV0gfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2tmaWxsRXZlbnRzID0geWllbGQgd2l0aEJhY2tvZmZSZXRyaWVzKCgpID0+IHdpdGhUaW1lb3V0KHRoaXMuYmFja2ZpbGxlci5nZXRMb2dzQmFja2ZpbGwoaXNDYW5jZWxsZWQsIGZpbHRlciwgc2VudEV2ZW50cywgc3RhcnRpbmdCbG9ja051bWJlciksIEJBQ0tGSUxMX1RJTUVPVVQpLCBCQUNLRklMTF9SRVRSSUVTLCAoKSA9PiAhaXNDYW5jZWxsZWQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93SWZDYW5jZWxsZWQoaXNDYW5jZWxsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudHMgPSBkZWR1cGVMb2dzKFsuLi5iYWNrZmlsbEV2ZW50cywgLi4uYmFja2ZpbGxCdWZmZXJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzLmZvckVhY2goZXZlbnQgPT4gdGhpcy5lbWl0TG9nc0V2ZW50KHZpcnR1YWxJZCwgZXZlbnQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLmlzQmFja2ZpbGxpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGJhY2tmaWxsQnVmZmVyLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGVtaXROZXdIZWFkc0V2ZW50KHZpcnR1YWxJZCwgcmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy5lbWl0QW5kUmVtZW1iZXJFdmVudCh2aXJ0dWFsSWQsIHJlc3VsdCwgZ2V0TmV3SGVhZHNCbG9ja051bWJlcik7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBlbWl0TG9nc0V2ZW50KHZpcnR1YWxJZCwgcmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy5lbWl0QW5kUmVtZW1iZXJFdmVudCh2aXJ0dWFsSWQsIHJlc3VsdCwgZ2V0TG9nc0Jsb2NrTnVtYmVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRW1pdHMgYW4gZXZlbnQgdG8gY29uc3VtZXJzLCBidXQgYWxzbyByZW1lbWJlcnMgaXQgaW4gaXRzIHN1YnNjcmlwdGlvbnMnc1xyXG4gICAgICogYHNlbnRFdmVudHNgIGJ1ZmZlciBzbyB0aGF0IHdlIGNhbiBkZXRlY3QgcmUtb3JncyBpZiB0aGUgY29ubmVjdGlvbiBkcm9wc1xyXG4gICAgICogYW5kIG5lZWRzIHRvIGJlIHJlY29ubmVjdGVkLlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBlbWl0QW5kUmVtZW1iZXJFdmVudCh2aXJ0dWFsSWQsIHJlc3VsdCwgZ2V0QmxvY2tOdW1iZXIpIHtcclxuICAgICAgICB0aGlzLnJlbWVtYmVyRXZlbnQodmlydHVhbElkLCByZXN1bHQsIGdldEJsb2NrTnVtYmVyKTtcclxuICAgICAgICB0aGlzLmVtaXRFdmVudCh2aXJ0dWFsSWQsIHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICBlbWl0RXZlbnQodmlydHVhbElkLCByZXN1bHQpIHtcclxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLnZpcnR1YWxTdWJzY3JpcHRpb25zQnlJZC5nZXQodmlydHVhbElkKTtcclxuICAgICAgICBpZiAoIXN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZW1pdEdlbmVyaWNFdmVudChzdWJzY3JpcHRpb24sIHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICByZW1lbWJlckV2ZW50KHZpcnR1YWxJZCwgcmVzdWx0LCBnZXRCbG9ja051bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMudmlydHVhbFN1YnNjcmlwdGlvbnNCeUlkLmdldCh2aXJ0dWFsSWQpO1xyXG4gICAgICAgIGlmICghc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gV2ViMyBtb2RpZmllcyB0aGVzZSBldmVudCBvYmplY3RzIG9uY2Ugd2UgcGFzcyB0aGVtIG9uIChjaGFuZ2luZyBoZXhcclxuICAgICAgICAvLyBudW1iZXJzIHRvIG51bWJlcnMpLiBXZSB3YW50IHRoZSBvcmlnaW5hbCBldmVudCwgc28gbWFrZSBhIGRlZmVuc2l2ZVxyXG4gICAgICAgIC8vIGNvcHkuXHJcbiAgICAgICAgYWRkVG9QYXN0RXZlbnRzQnVmZmVyKHN1YnNjcmlwdGlvbi5zZW50RXZlbnRzLCBPYmplY3QuYXNzaWduKHt9LCByZXN1bHQpLCBnZXRCbG9ja051bWJlcik7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBlbWl0R2VuZXJpY0V2ZW50KHN1YnNjcmlwdGlvbiwgcmVzdWx0KSB7XHJcbiAgICAgICAgY29uc3QgZW1pdEZ1bmN0aW9uID0gdGhpcy5lbWl0UHJvY2Vzc0ZuKHN1YnNjcmlwdGlvbi5ldmVudCk7XHJcbiAgICAgICAgZW1pdEZ1bmN0aW9uKHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyBhIGhlYXJ0YmVhdCB0aGF0IHBpbmdzIHRoZSB3ZWJzb2NrZXQgc2VydmVyIHBlcmlvZGljYWxseSB0byBlbnN1cmVcclxuICAgICAqIHRoYXQgdGhlIGNvbm5lY3Rpb24gc3RheXMgb3Blbi5cclxuICAgICAqXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgc3RhcnRIZWFydGJlYXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGVhcnRiZWF0SW50ZXJ2YWxJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5oZWFydGJlYXRJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgeWllbGQgd2l0aFRpbWVvdXQodGhpcy5zZW5kKCduZXRfdmVyc2lvbicpLCBIRUFSVEJFQVRfV0FJVF9USU1FKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dlYnNvY2tldC5yZWNvbm5lY3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLCBIRUFSVEJFQVRfSU5URVJWQUwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBzZW5kcyB0aGUgYmF0Y2ggY29uY3VycmVudGx5IGFzIGluZGl2aWR1YWwgcmVxdWVzdHMgcmF0aGVyIHRoYW5cclxuICAgICAqIGFzIGEgYmF0Y2gsIHdoaWNoIHdhcyB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb24uIFRoZSBvcmlnaW5hbCBiYXRjaCBsb2dpY1xyXG4gICAgICogaXMgcHJlc2VydmVkIGluIHRoaXMgaW1wbGVtZW50YXRpb24gaW4gb3JkZXIgZm9yIGZhc3RlciBwb3J0aW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXlsb2FkXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgLy8gVE9ETyhjbGVhbnVwKTogUmVmYWN0b3IgYW5kIHJlbW92ZSB1c2FnZXMgb2YgYHNlbmRCYXRjaCgpYC5cclxuICAgIC8vIFRPRE8oZXJyb3JzKTogVXNlIGFsbFNldHRsZWQoKSBvbmNlIHdlIGhhdmUgbW9yZSBlcnJvciBoYW5kbGluZy5cclxuICAgIHNlbmRCYXRjaENvbmN1cnJlbnRseShwYXlsb2FkKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHBheWxvYWQubWFwKHJlcSA9PiB0aGlzLnNlbmQocmVxLm1ldGhvZCwgcmVxLnBhcmFtcykpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGN1c3RvbVN0YXJ0RXZlbnQoZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gQUxDSEVNWV9QRU5ESU5HX1RSQU5TQUNUSU9OU19FVkVOVF9UWVBFKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZnJvbUFkZHJlc3MsIHRvQWRkcmVzcywgaGFzaGVzT25seSB9ID0gZXZlbnQ7XHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5fc3Vic2NyaWJlKGV2ZW50LnRhZywgW1xyXG4gICAgICAgICAgICAgICAgQWxjaGVteVN1YnNjcmlwdGlvbi5QRU5ESU5HX1RSQU5TQUNUSU9OUyxcclxuICAgICAgICAgICAgICAgIHsgZnJvbUFkZHJlc3MsIHRvQWRkcmVzcywgaGFzaGVzT25seSB9XHJcbiAgICAgICAgICAgIF0sIHRoaXMuZW1pdFByb2Nlc3NGbihldmVudCksIGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PT0gQUxDSEVNWV9NSU5FRF9UUkFOU0FDVElPTlNfRVZFTlRfVFlQRSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGFkZHJlc3NlcywgaW5jbHVkZVJlbW92ZWQsIGhhc2hlc09ubHkgfSA9IGV2ZW50O1xyXG4gICAgICAgICAgICB2b2lkIHRoaXMuX3N1YnNjcmliZShldmVudC50YWcsIFtcclxuICAgICAgICAgICAgICAgIEFsY2hlbXlTdWJzY3JpcHRpb24uTUlORURfVFJBTlNBQ1RJT05TLFxyXG4gICAgICAgICAgICAgICAgeyBhZGRyZXNzZXMsIGluY2x1ZGVSZW1vdmVkLCBoYXNoZXNPbmx5IH1cclxuICAgICAgICAgICAgXSwgdGhpcy5lbWl0UHJvY2Vzc0ZuKGV2ZW50KSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSAnYmxvY2snKSB7XHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5fc3Vic2NyaWJlKCdibG9jaycsIFsnbmV3SGVhZHMnXSwgdGhpcy5lbWl0UHJvY2Vzc0ZuKGV2ZW50KSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSAnZmlsdGVyJykge1xyXG4gICAgICAgICAgICB2b2lkIHRoaXMuX3N1YnNjcmliZShldmVudC50YWcsIFsnbG9ncycsIHRoaXMuX2dldEZpbHRlcihldmVudC5maWx0ZXIpXSwgdGhpcy5lbWl0UHJvY2Vzc0ZuKGV2ZW50KSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGVtaXRQcm9jZXNzRm4oZXZlbnQpIHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBBTENIRU1ZX1BFTkRJTkdfVFJBTlNBQ1RJT05TX0VWRU5UX1RZUEU6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0ID0+IHRoaXMuZW1pdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBBbGNoZW15U3Vic2NyaXB0aW9uLlBFTkRJTkdfVFJBTlNBQ1RJT05TLFxyXG4gICAgICAgICAgICAgICAgICAgIGZyb21BZGRyZXNzOiBldmVudC5mcm9tQWRkcmVzcyxcclxuICAgICAgICAgICAgICAgICAgICB0b0FkZHJlc3M6IGV2ZW50LnRvQWRkcmVzcyxcclxuICAgICAgICAgICAgICAgICAgICBoYXNoZXNPbmx5OiBldmVudC5oYXNoZXNPbmx5XHJcbiAgICAgICAgICAgICAgICB9LCByZXN1bHQpO1xyXG4gICAgICAgICAgICBjYXNlIEFMQ0hFTVlfTUlORURfVFJBTlNBQ1RJT05TX0VWRU5UX1RZUEU6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0ID0+IHRoaXMuZW1pdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBBbGNoZW15U3Vic2NyaXB0aW9uLk1JTkVEX1RSQU5TQUNUSU9OUyxcclxuICAgICAgICAgICAgICAgICAgICBhZGRyZXNzZXM6IGV2ZW50LmFkZHJlc3NlcyxcclxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlUmVtb3ZlZDogZXZlbnQuaW5jbHVkZVJlbW92ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFzaGVzT25seTogZXZlbnQuaGFzaGVzT25seVxyXG4gICAgICAgICAgICAgICAgfSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgY2FzZSAnYmxvY2snOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBCaWdOdW1iZXIuZnJvbShyZXN1bHQubnVtYmVyKS50b051bWJlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZWQuYmxvY2sgPSBibG9ja051bWJlcjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Jsb2NrJywgYmxvY2tOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FzZSAnZmlsdGVyJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucmVtb3ZlZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5yZW1vdmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdChldmVudC5maWx0ZXIsIHRoaXMuZm9ybWF0dGVyLmZpbHRlckxvZyhyZXN1bHQpKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZXZlbnQgdHlwZSB0byBgZW1pdFByb2Nlc3NGbigpYCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRE8gTk9UIE1PRElGWS5cclxuICAgICAqXHJcbiAgICAgKiBPcmlnaW5hbCBjb2RlIGNvcGllZCBvdmVyIGZyb20gZXRoZXIuanMncyBgQmFzZVByb3ZpZGVyLm9mZigpYC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBjb3BpZWQgb3ZlciBkaXJlY3RseSBpbiBvcmRlciB0byBpbXBsZW1lbnQgQWxjaGVteSdzIHVuaXF1ZVxyXG4gICAgICogc3Vic2NyaXB0aW9uIHR5cGVzLiBUaGUgb25seSBkaWZmZXJlbmNlIGlzIHRoYXQgdGhpcyBtZXRob2QgY2FsbHNcclxuICAgICAqIHtAbGluayBnZXRBbGNoZW15RXZlbnRUYWd9IGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIGBnZXRFdmVudFRhZygpYCBtZXRob2QgaW5cclxuICAgICAqIG9yZGVyIHRvIHBhcnNlIHRoZSBBbGNoZW15IHN1YnNjcmlwdGlvbiBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfb2ZmKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAobGlzdGVuZXIgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnROYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc3RvcHBlZCA9IFtdO1xyXG4gICAgICAgIGxldCBmb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGV2ZW50VGFnID0gZ2V0QWxjaGVteUV2ZW50VGFnKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzLmZpbHRlcihldmVudCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC50YWcgIT09IGV2ZW50VGFnIHx8IGV2ZW50Lmxpc3RlbmVyICE9IGxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgc3RvcHBlZC5wdXNoKGV2ZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN0b3BwZWQuZm9yRWFjaChldmVudCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0b3BFdmVudChldmVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIERPIE5PVCBNT0RJRlkuXHJcbiAgICAgKlxyXG4gICAgICogT3JpZ2luYWwgY29kZSBjb3BpZWQgb3ZlciBmcm9tIGV0aGVyLmpzJ3MgYEJhc2VQcm92aWRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKWAuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgY29waWVkIG92ZXIgZGlyZWN0bHkgaW4gb3JkZXIgdG8gaW1wbGVtZW50IEFsY2hlbXkncyB1bmlxdWVcclxuICAgICAqIHN1YnNjcmlwdGlvbiB0eXBlcy4gVGhlIG9ubHkgZGlmZmVyZW5jZSBpcyB0aGF0IHRoaXMgbWV0aG9kIGNhbGxzXHJcbiAgICAgKiB7QGxpbmsgZ2V0QWxjaGVteUV2ZW50VGFnfSBpbnN0ZWFkIG9mIHRoZSBvcmlnaW5hbCBgZ2V0RXZlbnRUYWcoKWAgbWV0aG9kIGluXHJcbiAgICAgKiBvcmRlciB0byBwYXJzZSB0aGUgQWxjaGVteSBzdWJzY3JpcHRpb24gZXZlbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX3JlbW92ZUFsbExpc3RlbmVycyhldmVudE5hbWUpIHtcclxuICAgICAgICBsZXQgc3RvcHBlZCA9IFtdO1xyXG4gICAgICAgIGlmIChldmVudE5hbWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBzdG9wcGVkID0gdGhpcy5fZXZlbnRzO1xyXG4gICAgICAgICAgICB0aGlzLl9ldmVudHMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50VGFnID0gZ2V0QWxjaGVteUV2ZW50VGFnKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhZyAhPT0gZXZlbnRUYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0b3BwZWQucHVzaChldmVudCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdG9wcGVkLmZvckVhY2goZXZlbnQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9zdG9wRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBETyBOT1QgTU9ESUZZLlxyXG4gICAgICpcclxuICAgICAqIE9yaWdpbmFsIGNvZGUgY29waWVkIG92ZXIgZnJvbSBldGhlci5qcydzIGBCYXNlUHJvdmlkZXIubGlzdGVuZXJDb3VudCgpYC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBjb3BpZWQgb3ZlciBkaXJlY3RseSBpbiBvcmRlciB0byBpbXBsZW1lbnQgQWxjaGVteSdzIHVuaXF1ZVxyXG4gICAgICogc3Vic2NyaXB0aW9uIHR5cGVzLiBUaGUgb25seSBkaWZmZXJlbmNlIGlzIHRoYXQgdGhpcyBtZXRob2QgY2FsbHNcclxuICAgICAqIHtAbGluayBnZXRBbGNoZW15RXZlbnRUYWd9IGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIGBnZXRFdmVudFRhZygpYCBtZXRob2QgaW5cclxuICAgICAqIG9yZGVyIHRvIHBhcnNlIHRoZSBBbGNoZW15IHN1YnNjcmlwdGlvbiBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfbGlzdGVuZXJDb3VudChldmVudE5hbWUpIHtcclxuICAgICAgICBpZiAoIWV2ZW50TmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnRzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZXZlbnRUYWcgPSBnZXRBbGNoZW15RXZlbnRUYWcoZXZlbnROYW1lKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnRzLmZpbHRlcihldmVudCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBldmVudC50YWcgPT09IGV2ZW50VGFnO1xyXG4gICAgICAgIH0pLmxlbmd0aDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRE8gTk9UIE1PRElGWS5cclxuICAgICAqXHJcbiAgICAgKiBPcmlnaW5hbCBjb2RlIGNvcGllZCBvdmVyIGZyb20gZXRoZXIuanMncyBgQmFzZVByb3ZpZGVyLmxpc3RlbmVycygpYC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBjb3BpZWQgb3ZlciBkaXJlY3RseSBpbiBvcmRlciB0byBpbXBsZW1lbnQgQWxjaGVteSdzIHVuaXF1ZVxyXG4gICAgICogc3Vic2NyaXB0aW9uIHR5cGVzLiBUaGUgb25seSBkaWZmZXJlbmNlIGlzIHRoYXQgdGhpcyBtZXRob2QgY2FsbHNcclxuICAgICAqIHtAbGluayBnZXRBbGNoZW15RXZlbnRUYWd9IGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIGBnZXRFdmVudFRhZygpYCBtZXRob2QgaW5cclxuICAgICAqIG9yZGVyIHRvIHBhcnNlIHRoZSBBbGNoZW15IHN1YnNjcmlwdGlvbiBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfbGlzdGVuZXJzKGV2ZW50TmFtZSkge1xyXG4gICAgICAgIGlmIChldmVudE5hbWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnRzLm1hcChldmVudCA9PiBldmVudC5saXN0ZW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGV2ZW50VGFnID0gZ2V0QWxjaGVteUV2ZW50VGFnKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50c1xyXG4gICAgICAgICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnRhZyA9PT0gZXZlbnRUYWcpXHJcbiAgICAgICAgICAgIC5tYXAoZXZlbnQgPT4gZXZlbnQubGlzdGVuZXIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldFdlYnNvY2tldENvbnN0cnVjdG9yKCkge1xyXG4gICAgcmV0dXJuIGlzTm9kZUVudmlyb25tZW50KCkgPyByZXF1aXJlKCd3ZWJzb2NrZXQnKS53M2N3ZWJzb2NrZXQgOiBXZWJTb2NrZXQ7XHJcbn1cclxuZnVuY3Rpb24gaXNOb2RlRW52aXJvbm1lbnQoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIHByb2Nlc3MgIT0gbnVsbCAmJlxyXG4gICAgICAgIHByb2Nlc3MudmVyc2lvbnMgIT0gbnVsbCAmJlxyXG4gICAgICAgIHByb2Nlc3MudmVyc2lvbnMubm9kZSAhPSBudWxsKTtcclxufVxyXG4vLyBUT0RPKGNsZWFudXApOiBVc2UgY2xhc3MgdmFyaWFibGUgcmF0aGVyIHRoYW4gcGFzc2luZyBgaXNDYW5jZWxsZWRgIGV2ZXJ5d2hlcmUuXHJcbmZ1bmN0aW9uIG1ha2VDYW5jZWxUb2tlbigpIHtcclxuICAgIGxldCBjYW5jZWxsZWQgPSBmYWxzZTtcclxuICAgIHJldHVybiB7IGNhbmNlbDogKCkgPT4gKGNhbmNlbGxlZCA9IHRydWUpLCBpc0NhbmNlbGxlZDogKCkgPT4gY2FuY2VsbGVkIH07XHJcbn1cclxuLy8gVE9ETyhjbGVhbnVwKTogcmVwbGFjZSB3aXRoIFNESydzIGJhY2tvZmYgaW1wbGVtZW50YXRpb25cclxuY29uc3QgTUlOX1JFVFJZX0RFTEFZID0gMTAwMDtcclxuY29uc3QgUkVUUllfQkFDS09GRl9GQUNUT1IgPSAyO1xyXG5jb25zdCBNQVhfUkVUUllfREVMQVkgPSAzMDAwMDtcclxuZnVuY3Rpb24gd2l0aEJhY2tvZmZSZXRyaWVzKGYsIHJldHJ5Q291bnQsIHNob3VsZFJldHJ5ID0gKCkgPT4gdHJ1ZSkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBsZXQgbmV4dFdhaXRUaW1lID0gMDtcclxuICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCBmKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSByZXRyeUNvdW50IHx8ICFzaG91bGRSZXRyeShlcnJvcikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHlpZWxkIGRlbGF5KG5leHRXYWl0VGltZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNob3VsZFJldHJ5KGVycm9yKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbmV4dFdhaXRUaW1lID1cclxuICAgICAgICAgICAgICAgICAgICBuZXh0V2FpdFRpbWUgPT09IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBNSU5fUkVUUllfREVMQVlcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBNYXRoLm1pbihNQVhfUkVUUllfREVMQVksIFJFVFJZX0JBQ0tPRkZfRkFDVE9SICogbmV4dFdhaXRUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGRlbGF5KG1zKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbn1cclxuZnVuY3Rpb24gd2l0aFRpbWVvdXQocHJvbWlzZSwgbXMpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJhY2UoW1xyXG4gICAgICAgIHByb21pc2UsXHJcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCdUaW1lb3V0JykpLCBtcykpXHJcbiAgICBdKTtcclxufVxyXG5mdW5jdGlvbiBnZXROZXdIZWFkc0Jsb2NrTnVtYmVyKGV2ZW50KSB7XHJcbiAgICByZXR1cm4gZnJvbUhleChldmVudC5udW1iZXIpO1xyXG59XHJcbmZ1bmN0aW9uIGdldExvZ3NCbG9ja051bWJlcihldmVudCkge1xyXG4gICAgcmV0dXJuIGZyb21IZXgoZXZlbnQuYmxvY2tOdW1iZXIpO1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVzcG9uc2UobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIChBcnJheS5pc0FycmF5KG1lc3NhZ2UpIHx8XHJcbiAgICAgICAgKG1lc3NhZ2UuanNvbnJwYyA9PT0gJzIuMCcgJiYgbWVzc2FnZS5pZCAhPT0gdW5kZWZpbmVkKSk7XHJcbn1cclxuZnVuY3Rpb24gaXNTdWJzY3JpcHRpb25FdmVudChtZXNzYWdlKSB7XHJcbiAgICByZXR1cm4gIWlzUmVzcG9uc2UobWVzc2FnZSk7XHJcbn1cclxuZnVuY3Rpb24gYWRkVG9OZXdIZWFkc0V2ZW50c0J1ZmZlcihwYXN0RXZlbnRzLCBldmVudCkge1xyXG4gICAgYWRkVG9QYXN0RXZlbnRzQnVmZmVyKHBhc3RFdmVudHMsIGV2ZW50LCBnZXROZXdIZWFkc0Jsb2NrTnVtYmVyKTtcclxufVxyXG5mdW5jdGlvbiBhZGRUb0xvZ3NFdmVudHNCdWZmZXIocGFzdEV2ZW50cywgZXZlbnQpIHtcclxuICAgIGFkZFRvUGFzdEV2ZW50c0J1ZmZlcihwYXN0RXZlbnRzLCBldmVudCwgZ2V0TG9nc0Jsb2NrTnVtYmVyKTtcclxufVxyXG4vKipcclxuICogQWRkcyBhIG5ldyBldmVudCB0byBhbiBhcnJheSBvZiBldmVudHMsIGV2aWN0aW5nIGFueSBldmVudHMgd2hpY2ggYXJlIHNvIG9sZFxyXG4gKiB0aGF0IHRoZXkgd2lsbCBubyBsb25nZXIgZmVhc2libHkgYmUgcGFydCBvZiBhIHJlb3JnLlxyXG4gKi9cclxuZnVuY3Rpb24gYWRkVG9QYXN0RXZlbnRzQnVmZmVyKHBhc3RFdmVudHMsIGV2ZW50LCBnZXRCbG9ja051bWJlcikge1xyXG4gICAgY29uc3QgY3VycmVudEJsb2NrTnVtYmVyID0gZ2V0QmxvY2tOdW1iZXIoZXZlbnQpO1xyXG4gICAgLy8gRmluZCBmaXJzdCBpbmRleCBvZiBhbiBldmVudCByZWNlbnQgZW5vdWdoIHRvIHJldGFpbiwgdGhlbiBkcm9wIGV2ZXJ5dGhpbmdcclxuICAgIC8vIGF0IGEgbG93ZXIgaW5kZXguXHJcbiAgICBjb25zdCBmaXJzdEdvb2RJbmRleCA9IHBhc3RFdmVudHMuZmluZEluZGV4KGUgPT4gZ2V0QmxvY2tOdW1iZXIoZSkgPiBjdXJyZW50QmxvY2tOdW1iZXIgLSBSRVRBSU5FRF9FVkVOVF9CTE9DS19DT1VOVCk7XHJcbiAgICBpZiAoZmlyc3RHb29kSW5kZXggPT09IC0xKSB7XHJcbiAgICAgICAgcGFzdEV2ZW50cy5sZW5ndGggPSAwO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcGFzdEV2ZW50cy5zcGxpY2UoMCwgZmlyc3RHb29kSW5kZXgpO1xyXG4gICAgfVxyXG4gICAgcGFzdEV2ZW50cy5wdXNoKGV2ZW50KTtcclxufVxuXG5leHBvcnQgeyBBbGNoZW15V2ViU29ja2V0UHJvdmlkZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFsY2hlbXktd2Vic29ja2V0LXByb3ZpZGVyLTdiMWUzNWIyLmpzLm1hcFxuIiwidmFyIG5haXZlRmFsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0eXBlb2Ygc2VsZiA9PT0gXCJvYmplY3RcIiAmJiBzZWxmKSByZXR1cm4gc2VsZjtcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgJiYgd2luZG93KSByZXR1cm4gd2luZG93O1xuXHR0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gcmVzb2x2ZSBnbG9iYWwgYHRoaXNgXCIpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcykgcmV0dXJuIHRoaXM7XG5cblx0Ly8gVW5leHBlY3RlZCBzdHJpY3QgbW9kZSAobWF5IGhhcHBlbiBpZiBlLmcuIGJ1bmRsZWQgaW50byBFU00gbW9kdWxlKVxuXG5cdC8vIEZhbGxiYWNrIHRvIHN0YW5kYXJkIGdsb2JhbFRoaXMgaWYgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gXCJvYmplY3RcIiAmJiBnbG9iYWxUaGlzKSByZXR1cm4gZ2xvYmFsVGhpcztcblxuXHQvLyBUaGFua3MgQG1hdGhpYXNieW5lbnMgLT4gaHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2dsb2JhbHRoaXNcblx0Ly8gSW4gYWxsIEVTNSsgZW5naW5lcyBnbG9iYWwgb2JqZWN0IGluaGVyaXRzIGZyb20gT2JqZWN0LnByb3RvdHlwZVxuXHQvLyAoaWYgeW91IGFwcHJvYWNoZWQgb25lIHRoYXQgZG9lc24ndCBwbGVhc2UgcmVwb3J0KVxuXHR0cnkge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYmplY3QucHJvdG90eXBlLCBcIl9fZ2xvYmFsX19cIiwge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LFxuXHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlXG5cdFx0fSk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0Ly8gVW5mb3J0dW5hdGUgY2FzZSBvZiB1cGRhdGVzIHRvIE9iamVjdC5wcm90b3R5cGUgYmVpbmcgcmVzdHJpY3RlZFxuXHRcdC8vIHZpYSBwcmV2ZW50RXh0ZW5zaW9ucywgc2VhbCBvciBmcmVlemVcblx0XHRyZXR1cm4gbmFpdmVGYWxsYmFjaygpO1xuXHR9XG5cdHRyeSB7XG5cdFx0Ly8gU2FmYXJpIGNhc2UgKHdpbmRvdy5fX2dsb2JhbF9fIHdvcmtzLCBidXQgX19nbG9iYWxfXyBkb2VzIG5vdClcblx0XHRpZiAoIV9fZ2xvYmFsX18pIHJldHVybiBuYWl2ZUZhbGxiYWNrKCk7XG5cdFx0cmV0dXJuIF9fZ2xvYmFsX187XG5cdH0gZmluYWxseSB7XG5cdFx0ZGVsZXRlIE9iamVjdC5wcm90b3R5cGUuX19nbG9iYWxfXztcblx0fVxufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFNIT1VMRF9SRUNPTk5FQ1RfRkFMU0VfTUVTU0FHRSA9IFwiUHJvdmlkZWQgc2hvdWxkUmVjb25uZWN0KCkgcmV0dXJuZWQgZmFsc2UuIENsb3NpbmcgcGVybWFuZW50bHkuXCI7XG52YXIgU0hPVUxEX1JFQ09OTkVDVF9QUk9NSVNFX0ZBTFNFX01FU1NBR0UgPSBcIlByb3ZpZGVkIHNob3VsZFJlY29ubmVjdCgpIHJlc29sdmVkIHRvIGZhbHNlLiBDbG9zaW5nIHBlcm1hbmVudGx5LlwiO1xudmFyIFN0dXJkeVdlYlNvY2tldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTdHVyZHlXZWJTb2NrZXQodXJsLCBwcm90b2NvbHNPck9wdGlvbnMsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XG4gICAgICAgIHRoaXMub25jbG9zZSA9IG51bGw7XG4gICAgICAgIHRoaXMub25lcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMub25tZXNzYWdlID0gbnVsbDtcbiAgICAgICAgdGhpcy5vbm9wZW4gPSBudWxsO1xuICAgICAgICB0aGlzLm9uZG93biA9IG51bGw7XG4gICAgICAgIHRoaXMub25yZW9wZW4gPSBudWxsO1xuICAgICAgICB0aGlzLkNPTk5FQ1RJTkcgPSBTdHVyZHlXZWJTb2NrZXQuQ09OTkVDVElORztcbiAgICAgICAgdGhpcy5PUEVOID0gU3R1cmR5V2ViU29ja2V0Lk9QRU47XG4gICAgICAgIHRoaXMuQ0xPU0lORyA9IFN0dXJkeVdlYlNvY2tldC5DTE9TSU5HO1xuICAgICAgICB0aGlzLkNMT1NFRCA9IFN0dXJkeVdlYlNvY2tldC5DTE9TRUQ7XG4gICAgICAgIHRoaXMuaGFzQmVlbk9wZW5lZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzQ2xvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLm5leHRSZXRyeVRpbWUgPSAwO1xuICAgICAgICB0aGlzLnJlY29ubmVjdENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5sYXN0S25vd25FeHRlbnNpb25zID0gXCJcIjtcbiAgICAgICAgdGhpcy5sYXN0S25vd25Qcm90b2NvbCA9IFwiXCI7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XG4gICAgICAgIGlmIChwcm90b2NvbHNPck9wdGlvbnMgPT0gbnVsbCB8fFxuICAgICAgICAgICAgdHlwZW9mIHByb3RvY29sc09yT3B0aW9ucyA9PT0gXCJzdHJpbmdcIiB8fFxuICAgICAgICAgICAgQXJyYXkuaXNBcnJheShwcm90b2NvbHNPck9wdGlvbnMpKSB7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29scyA9IHByb3RvY29sc09yT3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBwcm90b2NvbHNPck9wdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRpb25zID0gYXBwbHlEZWZhdWx0T3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMud3NDb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMud3NDb25zdHJ1Y3RvciA9IFdlYlNvY2tldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldlYlNvY2tldCBub3QgcHJlc2VudCBpbiBnbG9iYWwgc2NvcGUgYW5kIG5vIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ3c0NvbnN0cnVjdG9yIG9wdGlvbiB3YXMgcHJvdmlkZWQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMub3Blbk5ld1dlYlNvY2tldCgpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZSwgXCJiaW5hcnlUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iaW5hcnlUeXBlSW50ZXJuYWwgfHwgXCJibG9iXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGJpbmFyeVR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuYmluYXJ5VHlwZUludGVybmFsID0gYmluYXJ5VHlwZTtcbiAgICAgICAgICAgIGlmICh0aGlzLndzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cy5iaW5hcnlUeXBlID0gYmluYXJ5VHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUsIFwiYnVmZmVyZWRBbW91bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzdW0gPSB0aGlzLndzID8gdGhpcy53cy5idWZmZXJlZEFtb3VudCA6IDA7XG4gICAgICAgICAgICB2YXIgaGFzVW5rbm93bkFtb3VudCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVmZmVyLmZvckVhY2goZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnl0ZUxlbmd0aCA9IGdldERhdGFCeXRlTGVuZ3RoKGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmIChieXRlTGVuZ3RoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VtICs9IGJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoYXNVbmtub3duQW1vdW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChoYXNVbmtub3duQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1Z0xvZyhcIlNvbWUgYnVmZmVyZWQgZGF0YSBoYWQgdW5rbm93biBsZW5ndGguIGJ1ZmZlcmVkQW1vdW50KClcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIHJldHVybiB2YWx1ZSBtYXkgYmUgYmVsb3cgdGhlIGNvcnJlY3QgYW1vdW50LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLCBcImV4dGVuc2lvbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndzID8gdGhpcy53cy5leHRlbnNpb25zIDogdGhpcy5sYXN0S25vd25FeHRlbnNpb25zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZSwgXCJwcm90b2NvbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMud3MgPyB0aGlzLndzLnByb3RvY29sIDogdGhpcy5sYXN0S25vd25Qcm90b2NvbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUsIFwicmVhZHlTdGF0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNDbG9zZWQgPyBTdHVyZHlXZWJTb2NrZXQuQ0xPU0VEIDogU3R1cmR5V2ViU29ja2V0Lk9QRU47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoY29kZSwgcmVhc29uKSB7XG4gICAgICAgIHRoaXMuZGlzcG9zZVNvY2tldChjb2RlLCByZWFzb24pO1xuICAgICAgICB0aGlzLnNodXRkb3duKCk7XG4gICAgICAgIHRoaXMuZGVidWdMb2coXCJXZWJTb2NrZXQgcGVybWFuZW50bHkgY2xvc2VkIGJ5IGNsaWVudC5cIik7XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAodGhpcy5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiV2ViU29ja2V0IGlzIGFscmVhZHkgaW4gQ0xPU0lORyBvciBDTE9TRUQgc3RhdGUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMud3MgJiYgdGhpcy53cy5yZWFkeVN0YXRlID09PSB0aGlzLk9QRU4pIHtcbiAgICAgICAgICAgIHRoaXMud3Muc2VuZChkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlci5wdXNoKGRhdGEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLnJlY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNDbG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjYWxsIHJlY29ubmVjdCgpIG9uIHNvY2tldCB3aGljaCBpcyBwZXJtYW5lbnRseSBjbG9zZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcG9zZVNvY2tldCgxMDAwLCBcIkNsaWVudCByZXF1ZXN0ZWQgcmVjb25uZWN0LlwiKTtcbiAgICAgICAgdGhpcy5oYW5kbGVDbG9zZSh1bmRlZmluZWQpO1xuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNbdHlwZV0pIHtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW3R5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5saXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2hFdmVudE9mVHlwZShldmVudC50eXBlLCBldmVudCk7XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW3R5cGVdKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXSA9IHRoaXMubGlzdGVuZXJzW3R5cGVdLmZpbHRlcihmdW5jdGlvbiAobCkgeyByZXR1cm4gbCAhPT0gbGlzdGVuZXI7IH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLm9wZW5OZXdXZWJTb2NrZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9hID0gdGhpcy5vcHRpb25zLCBjb25uZWN0VGltZW91dCA9IF9hLmNvbm5lY3RUaW1lb3V0LCB3c0NvbnN0cnVjdG9yID0gX2Eud3NDb25zdHJ1Y3RvcjtcbiAgICAgICAgdGhpcy5kZWJ1Z0xvZyhcIk9wZW5pbmcgbmV3IFdlYlNvY2tldCB0byBcIiArIHRoaXMudXJsICsgXCIuXCIpO1xuICAgICAgICB2YXIgd3MgPSBuZXcgd3NDb25zdHJ1Y3Rvcih0aGlzLnVybCwgdGhpcy5wcm90b2NvbHMpO1xuICAgICAgICB3cy5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVDbG9zZShldmVudCk7IH07XG4gICAgICAgIHdzLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUVycm9yKGV2ZW50KTsgfTtcbiAgICAgICAgd3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVNZXNzYWdlKGV2ZW50KTsgfTtcbiAgICAgICAgd3Mub25vcGVuID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVPcGVuKGV2ZW50KTsgfTtcbiAgICAgICAgdGhpcy5jb25uZWN0VGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGlzIGlzIHJ1bm5pbmcsIHdlIHN0aWxsIGhhdmVuJ3Qgb3BlbmVkIHRoZSB3ZWJzb2NrZXQuXG4gICAgICAgICAgICAvLyBLaWxsIGl0IHNvIHdlIGNhbiB0cnkgYWdhaW4uXG4gICAgICAgICAgICBfdGhpcy5jbGVhckNvbm5lY3RUaW1lb3V0KCk7XG4gICAgICAgICAgICBfdGhpcy5kaXNwb3NlU29ja2V0KCk7XG4gICAgICAgICAgICBfdGhpcy5oYW5kbGVDbG9zZSh1bmRlZmluZWQpO1xuICAgICAgICB9LCBjb25uZWN0VGltZW91dCk7XG4gICAgICAgIHRoaXMud3MgPSB3cztcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuaGFuZGxlT3BlbiA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMud3MgfHwgdGhpcy5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbGxDbGVhclJlc2V0VGltZSA9IHRoaXMub3B0aW9ucy5hbGxDbGVhclJlc2V0VGltZTtcbiAgICAgICAgdGhpcy5kZWJ1Z0xvZyhcIldlYlNvY2tldCBvcGVuZWQuXCIpO1xuICAgICAgICBpZiAodGhpcy5iaW5hcnlUeXBlSW50ZXJuYWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy53cy5iaW5hcnlUeXBlID0gdGhpcy5iaW5hcnlUeXBlSW50ZXJuYWw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJpbmFyeVR5cGVJbnRlcm5hbCA9IHRoaXMud3MuYmluYXJ5VHlwZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyQ29ubmVjdFRpbWVvdXQoKTtcbiAgICAgICAgaWYgKHRoaXMuaGFzQmVlbk9wZW5lZCkge1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50T2ZUeXBlKFwicmVvcGVuXCIsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudE9mVHlwZShcIm9wZW5cIiwgZXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5oYXNCZWVuT3BlbmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIuZm9yRWFjaChmdW5jdGlvbiAobWVzc2FnZSkgeyByZXR1cm4gX3RoaXMuc2VuZChtZXNzYWdlKTsgfSk7XG4gICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLmFsbENsZWFyVGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5jbGVhckFsbENsZWFyVGltZW91dCgpO1xuICAgICAgICAgICAgX3RoaXMubmV4dFJldHJ5VGltZSA9IDA7XG4gICAgICAgICAgICBfdGhpcy5yZWNvbm5lY3RDb3VudCA9IDA7XG4gICAgICAgICAgICB2YXIgb3BlblRpbWUgPSAoYWxsQ2xlYXJSZXNldFRpbWUgLyAxMDAwKSB8IDA7XG4gICAgICAgICAgICBfdGhpcy5kZWJ1Z0xvZyhcIldlYlNvY2tldCByZW1haW5lZCBvcGVuIGZvciBcIiArIG9wZW5UaW1lICsgXCIgc2Vjb25kcy4gUmVzZXR0aW5nXCIgK1xuICAgICAgICAgICAgICAgIFwiIHJldHJ5IHRpbWUgYW5kIGNvdW50LlwiKTtcbiAgICAgICAgfSwgYWxsQ2xlYXJSZXNldFRpbWUpO1xuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5oYW5kbGVNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50T2ZUeXBlKFwibWVzc2FnZVwiLCBldmVudCk7XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLmhhbmRsZUNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9hID0gdGhpcy5vcHRpb25zLCBtYXhSZWNvbm5lY3RBdHRlbXB0cyA9IF9hLm1heFJlY29ubmVjdEF0dGVtcHRzLCBzaG91bGRSZWNvbm5lY3QgPSBfYS5zaG91bGRSZWNvbm5lY3Q7XG4gICAgICAgIHRoaXMuY2xlYXJDb25uZWN0VGltZW91dCgpO1xuICAgICAgICB0aGlzLmNsZWFyQWxsQ2xlYXJUaW1lb3V0KCk7XG4gICAgICAgIGlmICh0aGlzLndzKSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RLbm93bkV4dGVuc2lvbnMgPSB0aGlzLndzLmV4dGVuc2lvbnM7XG4gICAgICAgICAgICB0aGlzLmxhc3RLbm93blByb3RvY29sID0gdGhpcy53cy5wcm90b2NvbDtcbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZVNvY2tldCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudE9mVHlwZShcImRvd25cIiwgZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy5yZWNvbm5lY3RDb3VudCA+PSBtYXhSZWNvbm5lY3RBdHRlbXB0cykge1xuICAgICAgICAgICAgdGhpcy5zdG9wUmVjb25uZWN0aW5nKGV2ZW50LCB0aGlzLmdldFRvb01hbnlGYWlsZWRSZWNvbm5lY3RzTWVzc2FnZSgpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2lsbFJlY29ubmVjdCA9ICFldmVudCB8fCBzaG91bGRSZWNvbm5lY3QoZXZlbnQpO1xuICAgICAgICBpZiAodHlwZW9mIHdpbGxSZWNvbm5lY3QgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVdpbGxSZWNvbm5lY3Qod2lsbFJlY29ubmVjdCwgZXZlbnQsIFNIT1VMRF9SRUNPTk5FQ1RfRkFMU0VfTUVTU0FHRSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsUmVjb25uZWN0LnRoZW4oZnVuY3Rpb24gKHdpbGxSZWNvbm5lY3RSZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZVdpbGxSZWNvbm5lY3Qod2lsbFJlY29ubmVjdFJlc29sdmVkLCBldmVudCwgU0hPVUxEX1JFQ09OTkVDVF9QUk9NSVNFX0ZBTFNFX01FU1NBR0UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuaGFuZGxlRXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50T2ZUeXBlKFwiZXJyb3JcIiwgZXZlbnQpO1xuICAgICAgICB0aGlzLmRlYnVnTG9nKFwiV2ViU29ja2V0IGVuY291bnRlcmVkIGFuIGVycm9yLlwiKTtcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuaGFuZGxlV2lsbFJlY29ubmVjdCA9IGZ1bmN0aW9uICh3aWxsUmVjb25uZWN0LCBldmVudCwgZGVuaWFsUmVhc29uKSB7XG4gICAgICAgIGlmICh3aWxsUmVjb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnJlZXN0YWJsaXNoQ29ubmVjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdG9wUmVjb25uZWN0aW5nKGV2ZW50LCBkZW5pYWxSZWFzb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLnJlZXN0YWJsaXNoQ29ubmVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hID0gdGhpcy5vcHRpb25zLCBtaW5SZWNvbm5lY3REZWxheSA9IF9hLm1pblJlY29ubmVjdERlbGF5LCBtYXhSZWNvbm5lY3REZWxheSA9IF9hLm1heFJlY29ubmVjdERlbGF5LCByZWNvbm5lY3RCYWNrb2ZmRmFjdG9yID0gX2EucmVjb25uZWN0QmFja29mZkZhY3RvcjtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3RDb3VudCsrO1xuICAgICAgICB2YXIgcmV0cnlUaW1lID0gdGhpcy5uZXh0UmV0cnlUaW1lO1xuICAgICAgICB0aGlzLm5leHRSZXRyeVRpbWUgPSBNYXRoLm1heChtaW5SZWNvbm5lY3REZWxheSwgTWF0aC5taW4odGhpcy5uZXh0UmV0cnlUaW1lICogcmVjb25uZWN0QmFja29mZkZhY3RvciwgbWF4UmVjb25uZWN0RGVsYXkpKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vcGVuTmV3V2ViU29ja2V0KCk7IH0sIHJldHJ5VGltZSk7XG4gICAgICAgIHZhciByZXRyeVRpbWVTZWNvbmRzID0gKHJldHJ5VGltZSAvIDEwMDApIHwgMDtcbiAgICAgICAgdGhpcy5kZWJ1Z0xvZyhcIldlYlNvY2tldCB3YXMgY2xvc2VkLiBSZS1vcGVuaW5nIGluIFwiICsgcmV0cnlUaW1lU2Vjb25kcyArIFwiIHNlY29uZHMuXCIpO1xuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5zdG9wUmVjb25uZWN0aW5nID0gZnVuY3Rpb24gKGV2ZW50LCBkZWJ1Z1JlYXNvbikge1xuICAgICAgICB0aGlzLmRlYnVnTG9nKGRlYnVnUmVhc29uKTtcbiAgICAgICAgdGhpcy5zaHV0ZG93bigpO1xuICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudE9mVHlwZShcImNsb3NlXCIsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0Nsb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY2xlYXJBbGxUaW1lb3V0cygpO1xuICAgICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy5kaXNwb3NlU29ja2V0KCk7XG4gICAgfTtcbiAgICBTdHVyZHlXZWJTb2NrZXQucHJvdG90eXBlLmRpc3Bvc2VTb2NrZXQgPSBmdW5jdGlvbiAoY2xvc2VDb2RlLCByZWFzb24pIHtcbiAgICAgICAgaWYgKCF0aGlzLndzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gVXNlIG5vb3AgaGFuZGxlcnMgaW5zdGVhZCBvZiBudWxsIGJlY2F1c2Ugc29tZSBXZWJTb2NrZXRcbiAgICAgICAgLy8gaW1wbGVtZW50YXRpb25zLCBzdWNoIGFzIHRoZSBvbmUgZnJvbSBpc29tb3JwaGljLXdzLCByYWlzZSBhIHN0aW5rIG9uXG4gICAgICAgIC8vIHVuaGFuZGxlZCBldmVudHMuXG4gICAgICAgIHRoaXMud3Mub25lcnJvciA9IG5vb3A7XG4gICAgICAgIHRoaXMud3Mub25jbG9zZSA9IG5vb3A7XG4gICAgICAgIHRoaXMud3Mub25tZXNzYWdlID0gbm9vcDtcbiAgICAgICAgdGhpcy53cy5vbm9wZW4gPSBub29wO1xuICAgICAgICB0aGlzLndzLmNsb3NlKGNsb3NlQ29kZSwgcmVhc29uKTtcbiAgICAgICAgdGhpcy53cyA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuY2xlYXJBbGxUaW1lb3V0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGVhckNvbm5lY3RUaW1lb3V0KCk7XG4gICAgICAgIHRoaXMuY2xlYXJBbGxDbGVhclRpbWVvdXQoKTtcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuY2xlYXJDb25uZWN0VGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdFRpbWVvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jb25uZWN0VGltZW91dElkKTtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdFRpbWVvdXRJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5jbGVhckFsbENsZWFyVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYWxsQ2xlYXJUaW1lb3V0SWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuYWxsQ2xlYXJUaW1lb3V0SWQpO1xuICAgICAgICAgICAgdGhpcy5hbGxDbGVhclRpbWVvdXRJZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50T2ZUeXBlID0gZnVuY3Rpb24gKHR5cGUsIGV2ZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcImNsb3NlXCI6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25jbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uY2xvc2UoZXZlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9uZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWVzc2FnZVwiOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9ubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubWVzc2FnZShldmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm9wZW5cIjpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vbm9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbm9wZW4oZXZlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJkb3duXCI6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25kb3duKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25kb3duKGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVvcGVuXCI6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25yZW9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbnJlb3BlbihldmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlIGluIHRoaXMubGlzdGVuZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXVxuICAgICAgICAgICAgICAgIC5zbGljZSgpXG4gICAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7IHJldHVybiBfdGhpcy5jYWxsTGlzdGVuZXIobGlzdGVuZXIsIGV2ZW50KTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFldmVudCB8fCAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZDtcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuY2FsbExpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyLCBldmVudCkge1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdGVuZXIuaGFuZGxlRXZlbnQuY2FsbCh0aGlzLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuZGVidWdMb2cgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnKSB7XG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tY29uc29sZVxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5wcm90b3R5cGUuZ2V0VG9vTWFueUZhaWxlZFJlY29ubmVjdHNNZXNzYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWF4UmVjb25uZWN0QXR0ZW1wdHMgPSB0aGlzLm9wdGlvbnMubWF4UmVjb25uZWN0QXR0ZW1wdHM7XG4gICAgICAgIHJldHVybiBcIkZhaWxlZCB0byByZWNvbm5lY3QgYWZ0ZXIgXCIgKyBtYXhSZWNvbm5lY3RBdHRlbXB0cyArIFwiIFwiICsgcGx1cmFsaXplKFwiYXR0ZW1wdFwiLCBtYXhSZWNvbm5lY3RBdHRlbXB0cykgKyBcIi4gQ2xvc2luZyBwZXJtYW5lbnRseS5cIjtcbiAgICB9O1xuICAgIFN0dXJkeVdlYlNvY2tldC5ERUZBVUxUX09QVElPTlMgPSB7XG4gICAgICAgIGFsbENsZWFyUmVzZXRUaW1lOiA1MDAwLFxuICAgICAgICBjb25uZWN0VGltZW91dDogNTAwMCxcbiAgICAgICAgZGVidWc6IGZhbHNlLFxuICAgICAgICBtaW5SZWNvbm5lY3REZWxheTogMTAwMCxcbiAgICAgICAgbWF4UmVjb25uZWN0RGVsYXk6IDMwMDAwLFxuICAgICAgICBtYXhSZWNvbm5lY3RBdHRlbXB0czogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICAgICAgICByZWNvbm5lY3RCYWNrb2ZmRmFjdG9yOiAxLjUsXG4gICAgICAgIHNob3VsZFJlY29ubmVjdDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfSxcbiAgICAgICAgd3NDb25zdHJ1Y3RvcjogdW5kZWZpbmVkLFxuICAgIH07XG4gICAgU3R1cmR5V2ViU29ja2V0LkNPTk5FQ1RJTkcgPSAwO1xuICAgIFN0dXJkeVdlYlNvY2tldC5PUEVOID0gMTtcbiAgICBTdHVyZHlXZWJTb2NrZXQuQ0xPU0lORyA9IDI7XG4gICAgU3R1cmR5V2ViU29ja2V0LkNMT1NFRCA9IDM7XG4gICAgcmV0dXJuIFN0dXJkeVdlYlNvY2tldDtcbn0oKSk7XG5leHBvcnRzLmRlZmF1bHQgPSBTdHVyZHlXZWJTb2NrZXQ7XG5mdW5jdGlvbiBhcHBseURlZmF1bHRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgT2JqZWN0LmtleXMoU3R1cmR5V2ViU29ja2V0LkRFRkFVTFRfT1BUSU9OUykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnNba2V5XTtcbiAgICAgICAgcmVzdWx0W2tleV0gPVxuICAgICAgICAgICAgdmFsdWUgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgID8gU3R1cmR5V2ViU29ja2V0LkRFRkFVTFRfT1BUSU9OU1trZXldXG4gICAgICAgICAgICAgICAgOiB2YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0RGF0YUJ5dGVMZW5ndGgoZGF0YSkge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAvLyBVVEYtMTYgc3RyaW5ncyB1c2UgdHdvIGJ5dGVzIHBlciBjaGFyYWN0ZXIuXG4gICAgICAgIHJldHVybiAyICogZGF0YS5sZW5ndGg7XG4gICAgfVxuICAgIGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gZGF0YS5ieXRlTGVuZ3RoO1xuICAgIH1cbiAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICByZXR1cm4gZGF0YS5zaXplO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG59XG5mdW5jdGlvbiBwbHVyYWxpemUocywgbikge1xuICAgIHJldHVybiBuID09PSAxID8gcyA6IHMgKyBcInNcIjtcbn1cbmZ1bmN0aW9uIG5vb3AoKSB7XG4gICAgLy8gTm90aGluZy5cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsInZhciBfZ2xvYmFsVGhpcztcbmlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHtcblx0X2dsb2JhbFRoaXMgPSBnbG9iYWxUaGlzO1xufSBlbHNlIHtcblx0dHJ5IHtcblx0XHRfZ2xvYmFsVGhpcyA9IHJlcXVpcmUoJ2VzNS1leHQvZ2xvYmFsJyk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdH0gZmluYWxseSB7XG5cdFx0aWYgKCFfZ2xvYmFsVGhpcyAmJiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykgeyBfZ2xvYmFsVGhpcyA9IHdpbmRvdzsgfVxuXHRcdGlmICghX2dsb2JhbFRoaXMpIHsgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgZGV0ZXJtaW5lIGdsb2JhbCB0aGlzJyk7IH1cblx0fVxufVxuXG52YXIgTmF0aXZlV2ViU29ja2V0ID0gX2dsb2JhbFRoaXMuV2ViU29ja2V0IHx8IF9nbG9iYWxUaGlzLk1veldlYlNvY2tldDtcbnZhciB3ZWJzb2NrZXRfdmVyc2lvbiA9IHJlcXVpcmUoJy4vdmVyc2lvbicpO1xuXG5cbi8qKlxuICogRXhwb3NlIGEgVzNDIFdlYlNvY2tldCBjbGFzcyB3aXRoIGp1c3Qgb25lIG9yIHR3byBhcmd1bWVudHMuXG4gKi9cbmZ1bmN0aW9uIFczQ1dlYlNvY2tldCh1cmksIHByb3RvY29scykge1xuXHR2YXIgbmF0aXZlX2luc3RhbmNlO1xuXG5cdGlmIChwcm90b2NvbHMpIHtcblx0XHRuYXRpdmVfaW5zdGFuY2UgPSBuZXcgTmF0aXZlV2ViU29ja2V0KHVyaSwgcHJvdG9jb2xzKTtcblx0fVxuXHRlbHNlIHtcblx0XHRuYXRpdmVfaW5zdGFuY2UgPSBuZXcgTmF0aXZlV2ViU29ja2V0KHVyaSk7XG5cdH1cblxuXHQvKipcblx0ICogJ25hdGl2ZV9pbnN0YW5jZScgaXMgYW4gaW5zdGFuY2Ugb2YgbmF0aXZlV2ViU29ja2V0ICh0aGUgYnJvd3NlcidzIFdlYlNvY2tldFxuXHQgKiBjbGFzcykuIFNpbmNlIGl0IGlzIGFuIE9iamVjdCBpdCB3aWxsIGJlIHJldHVybmVkIGFzIGl0IGlzIHdoZW4gY3JlYXRpbmcgYW5cblx0ICogaW5zdGFuY2Ugb2YgVzNDV2ViU29ja2V0IHZpYSAnbmV3IFczQ1dlYlNvY2tldCgpJy5cblx0ICpcblx0ICogRUNNQVNjcmlwdCA1OiBodHRwOi8vYmNsYXJ5LmNvbS8yMDA0LzExLzA3LyNhLTEzLjIuMlxuXHQgKi9cblx0cmV0dXJuIG5hdGl2ZV9pbnN0YW5jZTtcbn1cbmlmIChOYXRpdmVXZWJTb2NrZXQpIHtcblx0WydDT05ORUNUSU5HJywgJ09QRU4nLCAnQ0xPU0lORycsICdDTE9TRUQnXS5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoVzNDV2ViU29ja2V0LCBwcm9wLCB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gTmF0aXZlV2ViU29ja2V0W3Byb3BdOyB9XG5cdFx0fSk7XG5cdH0pO1xufVxuXG4vKipcbiAqIE1vZHVsZSBleHBvcnRzLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAndzNjd2Vic29ja2V0JyA6IE5hdGl2ZVdlYlNvY2tldCA/IFczQ1dlYlNvY2tldCA6IG51bGwsXG4gICAgJ3ZlcnNpb24nICAgICAgOiB3ZWJzb2NrZXRfdmVyc2lvblxufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vcGFja2FnZS5qc29uJykudmVyc2lvbjtcbiJdLCJuYW1lcyI6WyJXUyIsIldlYlNvY2tldCIsIkVycm9yIiwiZXJyb3IiLCJsb2dnZXIiLCJ0aHJvd0Vycm9yIiwib3BlcmF0aW9uIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIk5leHRJZCIsIldlYlNvY2tldFByb3ZpZGVyIiwiY29uc3RydWN0b3IiLCJ1cmwiLCJuZXR3b3JrIiwic3VwZXIiLCJ0aGlzIiwiX3BvbGxpbmdJbnRlcnZhbCIsIl93c1JlYWR5IiwiY29ubmVjdGlvbiIsImRldGVjdE5ldHdvcmsiLCJ3ZWJzb2NrZXQiLCJvbm9wZW4iLCJPYmplY3QiLCJrZXlzIiwiX3JlcXVlc3RzIiwiZm9yRWFjaCIsImlkIiwic2VuZCIsInBheWxvYWQiLCJvbm1lc3NhZ2UiLCJtZXNzYWdlRXZlbnQiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwiU3RyaW5nIiwicmVxdWVzdCIsInVuZGVmaW5lZCIsImNhbGxiYWNrIiwiZW1pdCIsImFjdGlvbiIsInJlc3BvbnNlIiwicHJvdmlkZXIiLCJtZXNzYWdlIiwiY29kZSIsIm1ldGhvZCIsInN1YiIsIl9zdWJzIiwicGFyYW1zIiwic3Vic2NyaXB0aW9uIiwicHJvY2Vzc0Z1bmMiLCJjb25zb2xlIiwid2FybiIsImZhdXhQb2xsIiwic2V0SW50ZXJ2YWwiLCJ1bnJlZiIsIl93ZWJzb2NrZXQiLCJfZGV0ZWN0TmV0d29yayIsInBvbGxpbmdJbnRlcnZhbCIsInJlc2V0RXZlbnRzQmxvY2siLCJibG9ja051bWJlciIsInBvbGwiLCJwb2xsaW5nIiwicmlkIiwic3RyaW5naWZ5IiwianNvbnJwYyIsInN0YXRpYyIsIl9zdWJzY3JpYmUiLCJ0YWciLCJwYXJhbSIsInN1YklkUHJvbWlzZSIsIl9zdWJJZHMiLCJhbGwiLCJzdWJJZCIsIl9zdGFydEV2ZW50IiwiZXZlbnQiLCJ0eXBlIiwibnVtYmVyIiwidG9OdW1iZXIiLCJfZW1pdHRlZCIsImJsb2NrIiwiX2dldEZpbHRlciIsImZpbHRlciIsInJlbW92ZWQiLCJmb3JtYXR0ZXIiLCJmaWx0ZXJMb2ciLCJlbWl0UmVjZWlwdCIsImhhc2giLCJnZXRUcmFuc2FjdGlvblJlY2VpcHQiLCJyZWNlaXB0IiwiX2V2ZW50cyIsImxvZyIsIl9zdG9wRXZlbnQiLCJsZW5ndGgiLCJsaXN0ZW5lckNvdW50IiwiZGVzdHJveSIsInJlYWR5U3RhdGUiLCJvbmVycm9yIiwiY2xvc2UiLCJXZWJzb2NrZXRCYWNrZmlsbGVyIiwibWF4QmFja2ZpbGxCbG9ja3MiLCJnZXROZXdIZWFkc0JhY2tmaWxsIiwiaXNDYW5jZWxsZWQiLCJwcmV2aW91c0hlYWRzIiwiZnJvbUJsb2NrTnVtYmVyIiwiXyIsInRocm93SWZDYW5jZWxsZWQiLCJ0b0Jsb2NrTnVtYmVyIiwiZ2V0QmxvY2tOdW1iZXIiLCJnZXRIZWFkRXZlbnRzSW5SYW5nZSIsIk1hdGgiLCJtYXgiLCJsYXN0U2VlbkJsb2NrTnVtYmVyIiwiZiIsIm1pbkJsb2NrTnVtYmVyIiwicmVvcmdIZWFkcyIsImdldFJlb3JnSGVhZHMiLCJpbnRlcm1lZGlhdGVIZWFkcyIsImdldExvZ3NCYWNrZmlsbCIsInByZXZpb3VzTG9ncyIsImdldExvZ3NJblJhbmdlIiwiY29tbW9uQW5jZXN0b3IiLCJnZXRDb21tb25BbmNlc3RvciIsInJlbW92ZWRMb2dzIiwibWFwIiwiYXNzaWduIiwiZnJvbUJsb2NrSW5jbHVzaXZlIiwiTnVtYmVyIiwiTkVHQVRJVkVfSU5GSU5JVFkiLCJhZGRlZExvZ3MiLCJsb2dJbmRleCIsInNldE1heEJhY2tmaWxsQmxvY2siLCJuZXdNYXgiLCJibG9ja051bWJlckhleCIsInRvQmxvY2tFeGNsdXNpdmUiLCJiYXRjaFBhcnRzIiwiaSIsInB1c2giLCJ0Iiwic2VuZEJhdGNoIiwidG9OZXdIZWFkc0V2ZW50Iiwib2xkRXZlbnQiLCJibG9ja0hlYWQiLCJnZXRCbG9ja0J5TnVtYmVyIiwicmV2ZXJzZSIsIm9sZExvZyIsImJsb2NrSGFzaCIsInJhbmdlRmlsdGVyIiwiZnJvbUJsb2NrIiwidG9CbG9jayIsImhlYWQiLCJ0b3RhbERpZmZpY3VsdHkiLCJ0cmFuc2FjdGlvbnMiLCJ1bmNsZXMiLCJkZWR1cGUiLCJpdGVtcyIsImdldEtleSIsImtleXNTZWVuIiwiU2V0IiwiaXRlbSIsImtleSIsImhhcyIsImFkZCIsIkNBTkNFTExFRCIsIkFsY2hlbXlXZWJTb2NrZXRQcm92aWRlciIsImNvbmZpZyIsIndzQ29uc3RydWN0b3IiLCJfYSIsImFwaUtleSIsIkFsY2hlbXlQcm92aWRlciIsImFsY2hlbXlOZXR3b3JrIiwicHJvdG9jb2wiLCJWIiwicHJvY2VzcyIsInZlcnNpb25zIiwibm9kZSIsIkUiLCJ2aXJ0dWFsU3Vic2NyaXB0aW9uc0J5SWQiLCJNYXAiLCJ2aXJ0dWFsSWRzQnlQaHlzaWNhbElkIiwiaGFuZGxlTWVzc2FnZSIsIkFycmF5IiwiaXNBcnJheSIsImlzUmVzcG9uc2UiLCJpc1N1YnNjcmlwdGlvbkV2ZW50IiwicGh5c2ljYWxJZCIsInZpcnR1YWxJZCIsImdldCIsIm5ld0hlYWRzU3Vic2NyaXB0aW9uIiwibmV3SGVhZHNNZXNzYWdlIiwiaXNCYWNrZmlsbGluZyIsImJhY2tmaWxsQnVmZmVyIiwicGFzdEV2ZW50cyIsImFkZFRvUGFzdEV2ZW50c0J1ZmZlciIsImdldE5ld0hlYWRzQmxvY2tOdW1iZXIiLCJhZGRUb05ld0hlYWRzRXZlbnRzQnVmZmVyIiwiZW1pdEFuZFJlbWVtYmVyRXZlbnQiLCJyZW1lbWJlckV2ZW50IiwibG9nc1N1YnNjcmlwdGlvbiIsImxvZ3NNZXNzYWdlIiwiZ2V0TG9nc0Jsb2NrTnVtYmVyIiwiYWRkVG9Mb2dzRXZlbnRzQnVmZmVyIiwiZW1pdEV2ZW50IiwiaGFuZGxlUmVvcGVuIiwiY2xlYXIiLCJjYW5jZWwiLCJjYW5jZWxsZWQiLCJtYWtlQ2FuY2VsVG9rZW4iLCJjYW5jZWxCYWNrZmlsbCIsInZhbHVlcyIsInJlc3Vic2NyaWJlQW5kQmFja2ZpbGwiLCJzdGFydEhlYXJ0YmVhdCIsInN0b3BIZWFydGJlYXRBbmRCYWNrZmlsbCIsImhlYXJ0YmVhdEludGVydmFsSWQiLCJjbGVhckludGVydmFsIiwiYmFja2ZpbGxlciIsImFkZFNvY2tldExpc3RlbmVycyIsIm4iLCJDIiwib24iLCJldmVudE5hbWUiLCJsaXN0ZW5lciIsIl9hZGRFdmVudExpc3RlbmVyIiwib25jZSIsIm9mZiIsIl9vZmYiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJfcmVtb3ZlQWxsTGlzdGVuZXJzIiwiX2xpc3RlbmVyQ291bnQiLCJsaXN0ZW5lcnMiLCJfbGlzdGVuZXJzIiwidiIsIkEiLCJpbmNsdWRlcyIsImN1c3RvbVN0YXJ0RXZlbnQiLCJzdGFydGluZ0Jsb2NrTnVtYmVyIiwicmVzb2x2ZWRQYXJhbXMiLCJzZXQiLCJzZW50RXZlbnRzIiwiYXJncyIsInN0b3BwZWQiLCJldmVudFRhZyIsInNldFRpbWVvdXQiLCJwYXJ0cyIsIm5leHRJZCIsInNlbmRCYXRjaENvbmN1cnJlbnRseSIsInJlbW92ZVNvY2tldExpc3RlbmVycyIsImlzQ29tbXVuaXR5UmVzb3VyY2UiLCJEIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJiYWNrZmlsbEV2ZW50cyIsIndpdGhCYWNrb2ZmUmV0cmllcyIsIndpdGhUaW1lb3V0IiwiZXZlbnRzIiwiZW1pdE5ld0hlYWRzRXZlbnQiLCJkZWR1cGVMb2dzIiwiZW1pdExvZ3NFdmVudCIsImVtaXRHZW5lcmljRXZlbnQiLCJlbWl0UHJvY2Vzc0ZuIiwiZW1pdEZ1bmN0aW9uIiwicmVjb25uZWN0IiwicmVxIiwiZnJvbUFkZHJlc3MiLCJ0b0FkZHJlc3MiLCJoYXNoZXNPbmx5IiwiYWRkcmVzc2VzIiwiaW5jbHVkZVJlbW92ZWQiLCJmb3VuZCIsInJldHJ5Q291bnQiLCJzaG91bGRSZXRyeSIsIm5leHRXYWl0VGltZSIsImRlbGF5IiwibWluIiwibXMiLCJwcm9taXNlIiwicmFjZSIsImN1cnJlbnRCbG9ja051bWJlciIsImZpcnN0R29vZEluZGV4IiwiZmluZEluZGV4Iiwic3BsaWNlIiwibmFpdmVGYWxsYmFjayIsInNlbGYiLCJ3aW5kb3ciLCJtb2R1bGUiLCJleHBvcnRzIiwiZ2xvYmFsVGhpcyIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwiY29uZmlndXJhYmxlIiwiX19nbG9iYWxfXyIsIlN0dXJkeVdlYlNvY2tldCIsInByb3RvY29sc09yT3B0aW9ucyIsIm9wdGlvbnMiLCJvbmNsb3NlIiwib25kb3duIiwib25yZW9wZW4iLCJDT05ORUNUSU5HIiwiT1BFTiIsIkNMT1NJTkciLCJDTE9TRUQiLCJoYXNCZWVuT3BlbmVkIiwiaXNDbG9zZWQiLCJtZXNzYWdlQnVmZmVyIiwibmV4dFJldHJ5VGltZSIsInJlY29ubmVjdENvdW50IiwibGFzdEtub3duRXh0ZW5zaW9ucyIsImxhc3RLbm93blByb3RvY29sIiwicHJvdG9jb2xzIiwiYXBwbHlEZWZhdWx0T3B0aW9ucyIsIm9wZW5OZXdXZWJTb2NrZXQiLCJiaW5hcnlUeXBlSW50ZXJuYWwiLCJiaW5hcnlUeXBlIiwid3MiLCJlbnVtZXJhYmxlIiwic3VtIiwiYnVmZmVyZWRBbW91bnQiLCJoYXNVbmtub3duQW1vdW50IiwiYnl0ZUxlbmd0aCIsIkFycmF5QnVmZmVyIiwiQmxvYiIsInNpemUiLCJnZXREYXRhQnl0ZUxlbmd0aCIsImRlYnVnTG9nIiwiZXh0ZW5zaW9ucyIsInJlYXNvbiIsImRpc3Bvc2VTb2NrZXQiLCJzaHV0ZG93biIsImhhbmRsZUNsb3NlIiwiZGlzcGF0Y2hFdmVudCIsImRpc3BhdGNoRXZlbnRPZlR5cGUiLCJsIiwiX3RoaXMiLCJjb25uZWN0VGltZW91dCIsImhhbmRsZUVycm9yIiwiaGFuZGxlT3BlbiIsImNvbm5lY3RUaW1lb3V0SWQiLCJjbGVhckNvbm5lY3RUaW1lb3V0IiwiYWxsQ2xlYXJSZXNldFRpbWUiLCJhbGxDbGVhclRpbWVvdXRJZCIsImNsZWFyQWxsQ2xlYXJUaW1lb3V0Iiwib3BlblRpbWUiLCJtYXhSZWNvbm5lY3RBdHRlbXB0cyIsInNob3VsZFJlY29ubmVjdCIsInN0b3BSZWNvbm5lY3RpbmciLCJnZXRUb29NYW55RmFpbGVkUmVjb25uZWN0c01lc3NhZ2UiLCJ3aWxsUmVjb25uZWN0IiwiaGFuZGxlV2lsbFJlY29ubmVjdCIsIndpbGxSZWNvbm5lY3RSZXNvbHZlZCIsImRlbmlhbFJlYXNvbiIsInJlZXN0YWJsaXNoQ29ubmVjdGlvbiIsIm1pblJlY29ubmVjdERlbGF5IiwibWF4UmVjb25uZWN0RGVsYXkiLCJyZWNvbm5lY3RCYWNrb2ZmRmFjdG9yIiwicmV0cnlUaW1lIiwicmV0cnlUaW1lU2Vjb25kcyIsImRlYnVnUmVhc29uIiwiY2xlYXJBbGxUaW1lb3V0cyIsImNsb3NlQ29kZSIsIm5vb3AiLCJjbGVhclRpbWVvdXQiLCJzbGljZSIsImNhbGxMaXN0ZW5lciIsImRlZmF1bHRQcmV2ZW50ZWQiLCJjYWxsIiwiaGFuZGxlRXZlbnQiLCJkZWJ1ZyIsInMiLCJERUZBVUxUX09QVElPTlMiLCJQT1NJVElWRV9JTkZJTklUWSIsIl9nbG9iYWxUaGlzIiwiTmF0aXZlV2ViU29ja2V0IiwiTW96V2ViU29ja2V0Iiwid2Vic29ja2V0X3ZlcnNpb24iLCJXM0NXZWJTb2NrZXQiLCJ1cmkiLCJwcm9wIl0sInNvdXJjZVJvb3QiOiIifQ==